<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>All Posts - ğŸ“š | Dev Blog</title>
        <link>https://jaeyeonme.github.io/posts/</link>
        <description>All Posts | ğŸ“š | Dev Blog</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Thu, 30 Dec 2021 10:00:00 &#43;0000</lastBuildDate><atom:link href="https://jaeyeonme.github.io/posts/" rel="self" type="application/rss+xml" /><item>
    <title>ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ - ê¸°ë³¸ ë¬¸ë²•</title>
    <link>https://jaeyeonme.github.io/posts/jpa-object-query-language1/</link>
    <pubDate>Thu, 30 Dec 2021 10:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-object-query-language1/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ì†Œê°œ  JPAëŠ” ë‹¤ì–‘í•œ ì¿¼ë¦¬ ë°©ë²•ì„ ì§€ì›
 JPQL JPA Criteria QueryDSL Native SQL JDBC API ì§ì ‘ ì‚¬ìš©, MyBatis, SpringJdbcTemplate í•¨ê»˜ ì‚¬ìš©  JPQL ì†Œê°œ
 ê°€ì¥ ë‹¨ìˆœí•œ ì¡°íšŒ ë°©ë²•  EntityManager.find() ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ (a.getB().getC())   ë‚˜ì´ê°€ 18ì‚´ ì´ìƒì¸ íšŒì›ì„ ëª¨ë‘ ê²€ìƒ‰í•˜ê³  ì‹¶ë‹¤ë©´?  JPQL - í•„ìš”ì„±
 JPAë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹° ê°ì²´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ê°œë°œ ë¬¸ì œëŠ” ê²€ìƒ‰ ì¿¼ë¦¬ ê²€ìƒ‰ì„ í•  ë•Œë„ í…Œì´ë¸”ì´ ì•„ë‹Œ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ìƒ‰ ëª¨ë“  DB ë°ì´í„°ë¥¼ ê°ì²´ë¡œ ë³€í™˜í•´ì„œ ê²€ìƒ‰í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í•„ìš”í•œ ë°ì´í„°ë§Œ DBì—ì„œ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ ê²°êµ­ ê²€ ìƒ‰ ì¡°ê±´ì´ í¬í•¨ëœ SQLì´ í•„ìš”  JPQL - íŠ¹ì§•
  JPAëŠ” SQLì„ ì¶”ìƒí™”í•œ JPQLì´ë¼ëŠ” ê°ì²´ ì§€í–¥ ì¿¼ë¦¬ë¥¼ ì œê³µ
String sql = &#34;select m from Member.class as m where m.username like &#39;%until%&#39;&#34;; ì¼ë°˜ SQLê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ì—”í‹°í‹°ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•œë‹¤ëŠ” ì ì´ ë‹¤ë¥´ë‹¤.
 SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ SQLì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤. ë™ì  ì¿¼ë¦¬ ìƒì„±ì´ ì‰½ì§€ ì•Šë‹¤.    Criteria - ì†Œê°œ
 ë¬¸ìê°€ ì•„ë‹Œ ìë°”ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ  //Criteria ì‚¬ìš© ì¤€ë¹„ CriteriaBuilder cb = em.getCriteriaBuilder(); CriteriaQuery&lt;Member&gt; query = cb.createQuery(Member.class); //ë£¨íŠ¸ í´ë˜ìŠ¤ (ì¡°íšŒë¥¼ ì‹œì‘í•  í´ë˜ìŠ¤) Root&lt;Member&gt; m = query.from(Member.class); //ì¿¼ë¦¬ ìƒì„± CriteriaQuery&lt;Member&gt; cq = query.select(m).where(cb.equal(m.get(&#34;username&#34;), â€œkimâ€)); List&lt;Member&gt; resultList = em.createQuery(cq).getResultList()  JPQL ë¹Œë” ì—­í•  JPA ê³µì‹ ê¸°ëŠ¥  âŒì‹¤ë¬´ì—ì„  ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.
 ì¿¼ë¦¬ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ëŠ” ìˆì§€ë§Œ êµ¬í˜„ì´ ë„ˆë¬´ ë³µì¡í•˜ê³  ì‹¤ìš©ì„±ì´ ì—†ë‹¤. ë¬¸ìê°€ ì•„ë‹Œ ìë°”ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ JPQL ë¹Œë” ì—­í•  JPA ê³µì‹ ê¸°ëŠ¥ ë‹¨ì  : ë„ˆë¬´ ë³µì¡í•˜ê³  ì‹¤ìš©ì„±ì´ ì—†ë‹¤. Criteria ëŒ€ì‹ ì— QueryDSL ì‚¬ìš© ê¶Œì¥  QueryDSL ì†Œê°œ
ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬
// JPQL // SELECT m from Member m WHERE m.age &gt; 18 JPAFactoryQuery query = new JPAQueryFactory(em); QMember m = QMember.member; List&lt;Member&gt; list = query.selectFrom(m) .where(m.age.gt(18)) .orderBy(m.name.desc()) .fetch();   ë¬¸ìê°€ ì•„ë‹Œ ìë°”ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ
  JPQL ë¹Œë” ì—­í• 
  ì»´íŒŒì¼ ì‹œì ì— ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŒ
  ... List&lt;Member&gt; list = query.selectFrom(m) .wheree(m.age.gt(18)) //ì»´íŒŒì¼ ì‹œì ì—ì„œ ì˜¤ë¥˜ ê²€ì¶œ ê°€ëŠ¥  .orderBy(m.name.desc()) .fetch()  ë™ì ì¿¼ë¦¬ ì‘ì„± í¸ë¦¬í•¨ ë‹¨ìˆœí•˜ê³  ì‰½ë‹¤. ì‹¤ë¬´ ì‚¬ìš© ê¶Œì¥  ë„¤ì´í‹°ë¸Œ SQL ì†Œê°œ
  JPAê°€ ì œê³µí•˜ëŠ” SQLì„ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥
  JPQLë¡œ í•´ê²°í•  ìˆ˜ ì—†ëŠ” íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì˜ì¡´ì ì¸ ê¸°ëŠ¥
 ex: ì˜¤ë¼í´ CONNECT BY, íŠ¹ì • DBë§Œ ì‚¬ìš©í•œëŠ” SQL íŒíŠ¸  String sql =&#34;SELECT ID, AGE, TEAM_ID, NAME FROM MEMBER WHERE NAME = â€˜kimâ€™&#34;; List&lt;Member&gt; resultList = em.createNativeQuery(sql, Member.class) .getResultList();   JDBC ì§ì ‘ ì‚¬ìš©, SpringJdbcTemplate ë“±
  PAë¥¼ ì‚¬ìš©í•˜ë©´ì„œ JDBC ì»¤ë„¥ì…˜ì„ ì§ì ‘ ì‚¬ìš©í•˜ê±°ë‚˜, ìŠ¤í”„ë§ JdbcTemplate, ë§ˆì´ë°”í‹°ìŠ¤ë“± í•¨ê¼ ì‚¬ìš©ê°€ëŠ¥
  ë‹¨, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì ì ˆí•œ ì‹œì ì— ê°•ì œë¡œ í”ŒëŸ¬ì‹œ í•„ìš”
 ex: JPAë¥¼ ìš°íšŒí•´ì„œ SQLì„ ì‹¤í–‰í•˜ê¸° ì§ì „ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ë™ í”ŒëŸ¬ì‹œ í•´ì¤˜ì•¼ í•œë‹¤.  Member member = new Member(); member.setUsername(&#34;catsbi&#34;); conn.createQuery(&#34;select * from Member where username = &#39;catsbi&#39;&#34;); //ê²°ê³¼ ì—†ìŒ memberëŠ” Jdbcê°€ ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ”ì‹œì ì—ì„œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ë§Œ ìˆê³  dbì— ì•„ì§ ì €ì¥ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì¡°íšŒê²°ê³¼ê°€ ì—†ë‹¤ ê·¸ëŸ¬ë¯€ë¡œ ì¿¼ë¦¬ ìˆ˜í–‰ ì „ ìˆ˜ë™ìœ¼ë¡œ í”ŒëŸ¬ì‹œë¥¼ í•´ì¤˜ì•¼ í•œë‹¤.
  2. ê¸°ë³¸ ë¬¸ë²•ê³¼ ì¿¼ë¦¬ API  JPQL ì†Œê°œ
 JPQLì€ ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ë‹¤. ë”°ë¼ì„œ í…Œì´ë¸”ì„ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬í•œë‹¤. JPQLì€ SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ SQLì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.  EX: ì¡°íšŒ ê¸°ëŠ¥ì„ ë§Œë“¤ ë•Œ íŠ¹ì • DBì— ì˜ì¡´í•˜ëŠ” SQLì„ ë”°ë¡œ ì•ˆë§Œë“¤ì–´ë„ ëœë‹¤.   JPQLì€ ê²°êµ­ SQLë¡œ ë³€í™˜ëœë‹¤.  ê°ì²´/DB ëª¨ë¸]]></description>
</item><item>
    <title>ê°’ íƒ€ì…</title>
    <link>https://jaeyeonme.github.io/posts/jpa-value-type/</link>
    <pubDate>Wed, 29 Dec 2021 14:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-value-type/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ê¸°ë³¸ê°’ íƒ€ì…  ì—”í‹°í‹° íƒ€ì…
  @Entityë¡œ ì •ì˜í•˜ëŠ” ê°ì²´
  ë°ì´í„°ê°€ ë³€í•´ë„ ì‹ë³„ìë¡œ ì§€ì†í•´ì„œ ì¶”ì  ê°€ëŠ¥
â‡’ ì—”í‹°í‹° ë‚´ë¶€ì˜ ëª¨ë“  ê°’ë“¤ì„ ë°”ê¿”ë„ ì‹ë³„ìë§Œ ìœ ì§€ë˜ë©´ ì¶”ì ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì˜ë¯¸
  Ex: íšŒì› ì—”í‹°í‹°ì˜ í‚¤ë‚˜ ë‚˜ì´ ê°’ì„ ë³€ê²½í•´ë„ ì‹ë³„ìë¡œ ì¸ì‹ ê°€ëŠ¥
  ê°’ íƒ€ì…
 int, integer, Stringì²˜ëŸ¼ ë‹¨ìˆœíˆ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìë°” ê¸°ë³¸ íƒ€ì…ì´ë‚˜ ê°ì²´ ì‹ë³„ìê°€ ì—†ê³  ê°’ë§Œ ìˆìœ¼ë¯€ë¡œ ë³€ê²½ì‹œ ì¶”ì  ë¶ˆê°€ Ex: ìˆ«ì 100ì„ 200ìœ¼ë¡œ ë³€ê²½í•˜ë©´ ì™„ì „íˆ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ëŒ€ì²´  ê°’ íƒ€ì… ë¶„ë¥˜
 ê¸°ë³¸ê°’ íƒ€ì…  ìë°” ê¸°ë³¸ íƒ€ì…(int, double) ë˜í¼ í´ë˜ìŠ¤(Integer, Long) String   ì„ë² ë””ë“œ íƒ€ì…(enbedded type, ë³µí•© ê°’ íƒ€ì…)  Ex: ìš°í¸ë²ˆí˜¸, ì¢Œí‘œê°™ì€ ë³µí•© ê°’ì„ Positioní´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ ì“°ë ¤ê³  í•˜ëŠ” ê²ƒì„ ì„ë² ë””ë“œ íƒ€ì…   ì»¬ë ‰ì…˜ ê°’ íƒ€ì…(collection value type)  Java collection(Array, Map, Set)ì— ê°’ì„ ë„£ì„ìˆ˜ ìˆëŠ” ê²ƒì„ ì»¬ë ‰ì…˜ ê°’ íƒ€ì…ì´ë¼ í•œë‹¤.    ê°’ íƒ€ì… : ê¸°ë³¸ê°’ íƒ€ì…
 Ex: String name, int age ìƒëª…ì£¼ê¸°ë¥¼ ì—”í‹°í‹°ì— ì˜ì¡´  íšŒì›ì„ ì‚­ì œí•˜ë©´ ì´ë¦„, ë‚˜ì´ í•„ë“œë„ í•¨ê»˜ ì‚­ì œ   ê°’ íƒ€ì…ì€ ê³µìœ í•˜ë©´ ì•ˆëœë‹¤.  Side Effect â†’ íšŒì› ì´ë¦„ ë³€ê²½ì‹œ ë‹¤ë¥¸ íšŒì›ì˜ ì´ë¦„ë„ í•¨ê»˜ ë³€ê²½ë˜ë©´ ì•ˆëœë‹¤.     ì°¸ê³ : ìë°”ì˜ ê¸°ë³¸ íƒ€ì…ì€ ì ˆëŒ€ ê³µìœ ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤.  int, double ê°™ì€ ê¸°ë³¸ íƒ€ì…(primitive type)ì€ ì ˆëŒ€ ê³µìœ ë˜ì§€ ì•ŠëŠ”ë‹¤. ê¸°ë³¸ íƒ€ì…ì€ í•­ìƒ ê°’ì„ ë³µì‚¬í•¨ Integerê°™ì€ ë˜í¼ í´ë˜ìŠ¤ë‚˜ String ê°™ì€ íŠ¹ìˆ˜í•œ í´ë˜ìŠ¤ëŠ” ê³µìœ  ê°€ëŠ¥í•œ ê°ì²´ì´ì§€ë§Œ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤.    2. ì„ë² ë””ë“œ íƒ€ì…  ê°œìš”
 ìƒˆë¡œìš´ ê°’ íƒ€ì…ì„ ì§ì ‘ ì •ì˜í•  ìˆ˜ ìˆë‹¤. JPAëŠ” ì„ë² ë””ë“œ íƒ€ì…(embedded type)ì´ë¼ í•œë‹¤. ì£¼ë¡œ ê¸°ë³¸ ê°’ íƒ€ì…ì„ ëª¨ì•„ì„œ ë§Œë“¤ì–´ì„œ ë³µí•© ê°’ íƒ€ì…ì´ë¼ê³ ë„ í•¨ int, Stringê³¼ ê°™ì€ ê°’ íƒ€ì…  ì„ë² ë””ë“œ íƒ€ì… ì‚¬ìš©ë²•
 @Embeddable : ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ @Embedded : ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜   Example  ì˜ˆì œë¥¼ í†µí•´ ì•Œì•„ë³´ëŠ”ê²Œ ì´í•´í•˜ê¸° ì‰½ë‹¤.  íšŒì› ì—”í‹°í‹°ëŠ” ì´ë¦„, ê·¼ë¬´ ì‹œì‘ì¼, ê·¼ë¬´ ì¢…ë£Œì¼, ì£¼ì†Œ ë„ì‹œ, ì£¼ì†Œ ë²ˆì§€, ì£¼ì†Œ ìš°í¸ë²ˆí˜¸ë¥¼ ê°€ì§„ë‹¤.
  city, street, zipcodeëŠ” ì£¼ì†Œë¡œ í•©ì¹  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.
  ê·¼ë¬´ ì‹œì‘ì¼, ê·¼ë¬´ ì¢…ë£Œì¼ì€ ê·¼ë¬´ì‹œê°„ìœ¼ë¡œ í•©ì¹  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.
  íšŒì› ì—”í‹°í‹°ì˜ ëª‡ëª‡ ê°’ì„ ì£¼ì†Œ, ê·¼ë¬´ì‹œê°„ìœ¼ë¡œ í•©ì¹˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ.
ì½”ë“œë¥¼ í†µí•´ ì¢€ ë” ìì„¸íˆ ì•Œì•„ë³´ì.
@Embeddable //ê°’ íƒ€ì…ì´ ì •ì˜ë˜ëŠ” ê³³ì— @Embeddable ì‚¬ìš© public class Period { private LocalDateTime startDate; private LocalDateTime endDate; public Period() { } } @Embeddable //ê°’ íƒ€ì…ì´ ì •ì˜ë˜ëŠ” ê³³ì— @Embeddable ì‚¬ìš© public class Address { private String city; private String street; private String zipcode; public Address() { } } @Entity public class Member { @Id @GeneratedValue @Column(name = &#34;MEMBER_ID&#34;) private Long id; @Column(name = &#34;USERNAME&#34;) private String name; /* //ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì£¼ì„ ë‚´ì˜ ê¸°ì¡´ í˜•íƒœë¡œ ê°’ íƒ€ì…ìœ¼ë¡œ ì„ ì–¸í•´ì¤˜ì•¼ í•œë‹¤. //Period private LocalDateTime startDate; private LocalDateTime endDate; //Address private String city; private String street; private String zipcode; */ @Embedded //ê°’ íƒ€ì…ì´ ì‚¬ìš©ë˜ëŠ” ê³³ì— @Embedded ì‚¬ìš©  private Period workPeriod; @Embedded //ê°’ íƒ€ì…ì´ ì‚¬ìš©ë˜ëŠ” ê³³ì— @Embedded ì‚¬ìš©  private Address homeAddress; } 
ì„ë² ë””ë“œ íƒ€ì…ì˜ ì¥ì 
 ì¬ì‚¬ìš©  Periodë‚˜ AddressëŠ” ë‹¤ë¥¸ ê°ì²´ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ ì¬ì‚¬ìš©ì„±ì„ ë†’íŒë‹¤.   ë†’ì€ ì‘ì§‘ë„ Period.isWork()ì²˜ëŸ¼ í•´ë‹¹ ê°’ íƒ€ì…ë§Œ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ìˆëŠ” ë©”ì†Œë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ  private boolean isWork(){ ... }  ì„ë² ë””ë“œ íƒ€ì…ì„ í¬í•¨í•œ ëª¨ë“  ê°’ íƒ€ì…ì€, ê°’ íƒ€ì…ì„ ì†Œìœ í•œ ì—”í‹°í‹°ì— ìƒëª…ì£¼ê¸°ë¥¼ ì˜ì¡´í•œë‹¤.]]></description>
</item><item>
    <title>í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„ ê´€ë¦¬</title>
    <link>https://jaeyeonme.github.io/posts/jpa-proxy-and-management/</link>
    <pubDate>Wed, 29 Dec 2021 13:40:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-proxy-and-management/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. í”„ë¡ì‹œ   í”„ë¡ì‹œë€?
 í…Œì´ë¸”ì„ ì¡°íšŒí•´ì„œ ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ì—°ê´€ê´€ê³„ ê°ì²´ëŠ” ì•ˆê°€ì ¸ ì˜¤ê³  ì‹¶ìœ¼ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?
  em.find() : ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ
  em.getReference(): ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒë¥¼ ë¯¸ë£¨ëŠ” ê°€ì§œ(í”„ë¡ì‹œ) ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ
Member member = em.getReference(Member.class, 1L); System.out.println(&#34;member = &#34; + member.getClass()); // HibernateProxy ê°ì²´ getReference() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì§„ì§œ ê°ì²´ê°€ ì•„ë‹Œ í•˜ì´ë²„ë„¤ì´íŠ¸ ë‚´ë¶€ ë¡œì§ìœ¼ë¡œ í”„ë¡ì‹œ ì—”í‹°í‹° ê°ì²´ ë°˜í™˜
ë‚´ë¶€ êµ¬ì¡°ëŠ” í‹€ì€ ê°™ì§€ë§Œ ë‚´ìš©ì´ ë¹„ì–´ìˆë‹¤.
í”„ë¡ì‹œ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤." í”„ë¡ì‹œ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.    íŠ¹ì§•
  ì‹¤ì œ í´ë˜ìŠ¤ë¥¼ìƒì†ë°›ì•„ì„œ ë§Œë“¤ì–´ì§
  ì‹¤ì œ í´ë˜ìŠ¤ì™€ ê²‰ ëª¨ì–‘ì´ ê°™ë‹¤.
  ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œëŠ” ì§„ì§œ ê°ì²´ì¸ì§€ êµ¬ë¶„ í•„ìš”ê°€ ì—†ë‹¤. (ì´ë¡ ì ìœ¼ë¡œ)
  í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ì°¸ì¡°(target)ë¥¼ ë³´ê´€í•œë‹¤.
  í”„ë¡ì‹œ ê°ì²´ë¥¼ í˜¸ì¶œ(getName())í•˜ë©´ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ë©”ì†Œë“œ í˜¸ì¶œ
  í”„ë¡ì‹œëŠ” ì²˜ìŒ ì‚¬ìš©í•  ë•Œ í•œ ë²ˆë§Œ ì´ˆê¸°í™”
  í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ˆê¸°í™” í•  ë•Œ í”„ë¡ì‹œ ê°ì²´ê°€ ì‹¤ì œ ì—”í‹°í‹°ë¡œ ë°”ë€ŒëŠ” ê²ƒì€ ì•„ë‹˜, ì´ˆê¸°í™”ë˜ë©´ í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ ì‹¤ì œ ì—”í‹°í‹°ì— ì ‘ê·¼ ê°€ëŠ¥
  í”„ë¡ì‹œ ê°ì²´ëŠ” ì›ë³¸ ì—”í‹°í‹°ë¥¼ ìƒì†ë°›ìŒ, ë”°ë¼ì„œ íƒ€ì… ì²´í¬ì‹œ ì£¼ì˜í•´ì•¼í•¨( == ë¹„êµ ì‹¤íŒ¨, ëŒ€ì‹  instance of ì‚¬ìš©)
m1.getClass() == m2.getClass() //false m1 instanceof Member m2 instanceof Member     ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì°¾ëŠ” ì—”í‹°í‹°ê°€ ì´ë¯¸ ìˆìœ¼ë©´ em.getReference()ë¥¼ í˜¸ì¶œí•´ë„ ì‹¤ì œ ì—”í‹°í‹° ë°˜í™˜
Member m1 = em.find(Member.class, member1.getId()); System.out.println(&#34;m1 = &#34;+ m1.getClass());//Member  Member reference = em.getReference(Member.class, member1.getId()); System.out.println(&#34;reference = &#34; reference.getClass()); //Member  m1 == reference //true ì´ë¯¸ Memberë¥¼ 1ì°¨ ìºì‹œì—ë„ ì˜¬ë¼ì™€ ìˆëŠ”ë°, í”„ë¡ì‹œë¥¼ ë°˜í™˜í•  í•„ìš”ê°€ ì—†ë‹¤.
    ë°˜ëŒ€ë¡œ getReference()ë¡œ í”„ë¡ì‹œê°ì²´ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©´ ì‹¤ì œë¡œ find()ë¥¼ í–ˆì„ë•Œë„ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë°˜í™˜í•¨
  ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ì—†ëŠ” ì¤€ì˜ì† ìƒíƒœì¼ ë•Œ, í”„ë¡ì‹œë¥¼ ì´ˆê¸°í™”í•˜ë©´ ë¬¸ì œ ë°œìƒ
Member refMember = em.getReference(Member.class, member.getId()); System.out.println(&#34;refMember = &#34;+ refMember.getClass());//Proxy  em.detach(refMember); //em.clear  refMember.getUsername(); //org.hibernate.LazyInitializationException   í”„ë¡ì‹œ ê°ì²´ì˜ ì´ˆê¸°í™”
Member member = em.getRefernce(Member.class, &#34;id1&#34;);//(1) member.getName();//(2) ì½”ë“œ 1ë¼ì¸ì—ì„œ getReference()ë¥¼ í˜¸ì¶œí•˜ë©´ í”„ë¡ì‹œê°ì²´ë¥¼ ê°€ì ¸ì˜¨ ë‹¤ìŒ, getName()ì„ í˜¸ì¶œí•˜ë©´
JPAê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì´ˆê¸°í™” ìš”ì²­ì„ í•œë‹¤.
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œëŠ” ì‹¤ì œ DBë¥¼ ì¡°íšŒí•´ì„œ ê°€ì ¸ì˜¨ ë‹¤ìŒ ì‹¤ì œ Entityì— ê°’ì„ ë„£ì–´ ìƒì„±í•œ ë‹¤ìŒ í”„ë¡ì‹œ ê°ì²´ëŠ”
ì‹¤ì œ ì—”í‹°í‹°ë¥¼ ì—°ê²°í•´ì„œ ì‹¤ì œ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•œë‹¤.
ê·¸ ì´í›„ì—ëŠ” ì´ë¯¸ ì´ˆê¸°í™”ë˜ì–´ìˆëŠ” í”„ë¡ì‹œê°ì²´ ì—¬ê¸°ì— í•´ë‹¹ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•œë‹¤.
í”„ë¡ì‹œ í™•ì¸
 í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ì˜ ì´ˆê¸°í™” ì—¬ë¶€ í™•ì¸ : PersistenceUnitUtil.isLoaded(Object entity) â†’ entityManagerFactory.getPersistenceUnitUtil().isLoaded(object) í”„ë¡ì‹œ í´ë˜ìŠ¤ í™•ì¸ ë°©ë²• : entity.getClass().getname() ì¶œë ¥(..javasist.. or HibernateProxy&hellip;) í”„ë¡ì‹œ ê°•ì œ ì´ˆê¸°í™” : org.hibernate.Hibernate.initialize(entity); ì°¸ê³ : JPA í‘œì¤€ì€ ê°•ì œ ì´ˆê¸°í™” ì—†ìŒ ê°•ì œí˜¸ì¶œ : method.getName();  2. ì¦‰ì‹œë¡œë”©ê³¼ ì§€ì—°ë¡œë”©  ì§€ì—° ë¡œë”© Memberë¥¼ ì¡°íšŒí•  ë•Œ Team(ì—°ê´€ê´€ê³„)ë„ í•¨ê»˜ ì¡°íšŒí•´ì•¼ í• ê¹Œ? : ë‹¨ìˆœíˆ member ì •ë³´ë§Œì‚¬ìš©í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
ì§€ì—° ë¡œë”© LAZYì„ ì‚¬ìš©í•´ì„œ í”„ë¡ì‹œë¡œ ì¡°íšŒ
fetch = FetchType.LAZY
/*Member*/ @Entity public class Member { ... @ManyToOne(fetch = FetchType.LAZY) //ì§€ì—°ë¡œë”© ì‚¬ìš©  @JoinColumn(name=&#34;TEAM_ID&#34;) private Team team; ... } ... Member m = em.find(Member.class, member1.getId()); // Member ê°ì²´ ë°˜í™˜ System.out.println(&#34;m = &#34;+ m.getTeam().getClass()); // Team$HibernateProxyê°ì²´ ë°˜í™˜ m.getTeam().getName() // teamì„ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ëŠ” ì‹œì ì—ì„œ dbì¡°íšŒ ì—”í‹°í‹° ë°˜í™˜ ... ì—°ê´€ê´€ê³„ì— ìˆëŠ” ë‹¤ë¥¸ ì—”í‹°í‹°ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¹ˆë„ìˆ˜ê°€ ë‚®ì„ ê²½ìš° ì§€ì—°ë¡œë”©ì„ ì‚¬ìš©í•´ ë¶ˆí•„ìš”í•œ ì—”í‹°í‹° ì¡°íšŒë¥¼ ë§‰ì„ ìˆ˜ ìˆë‹¤.
ì¦‰ì‹œ ë¡œë”© â“Memberì™€ Teamì„ ê°™ì´ ì“°ëŠ” ë¹ˆë„ê°€ ë†’ì„ ê²½ìš°ì—ëŠ” ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?
ì¦‰ì‹œ ë¡œë”© EAGERë¥¼ ì‚¬ìš©í•´ì„œ í•¨ê¼ ì¡°íšŒ fetch = FetchType.EAGER
/*Member*/ @Entity public class Member{ ... @ManyToOne(fetch = FetchType.EAGER) //ì¦‰ì‹œë¡œë”© ì‚¬ìš©  @JoinColumn(name=&#34;TEAM_ID&#34;) private Team team; ... } ... Member m = em.]]></description>
</item><item>
    <title>ê³ ê¸‰ ë§¤í•‘</title>
    <link>https://jaeyeonme.github.io/posts/jpa-advanced-mapping/</link>
    <pubDate>Wed, 29 Dec 2021 13:20:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-advanced-mapping/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ìƒì†ê´€ê³„ ë§¤í•‘   ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìƒì† ê´€ê³„X ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ê´€ê³„ë¼ëŠ” ëª¨ë¸ë§ ê¸°ë²•ì´ ê°ì²´ ìƒì†ê³¼ ìœ ì‚¬ ìƒì†ê´€ê³„ ë§¤í•‘ : ê°ì²´ì˜ ìƒì†ê³¼ êµ¬ì¡°ì™€ DBì˜ ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ê´€ê³„ë¥¼ ë§¤í•‘  Album, Movie, Bookì€ ëª¨ë‘ id, name, priceë¥¼ ê°€ì§€ê³  ìˆë‹¤(ê³µí†µ ë³€ìˆ˜)
ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ë…¼ë¦¬ ëª¨ë¸ì„ ì‹¤ì œ ë¬¼ë¦¬ ëª¨ë¸ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²• 1. ì¡°ì¸ì „ëµ  Item, Albumì— PK,FKê°€ ê°™ì•„ ê°ê°ì˜ í…Œì´ë¸”ì— insertê°€ ìˆ˜í–‰í•˜ê³  Itemë‚´ì— íƒ€ì…ì„ êµ¬ë¶„í•˜ëŠ” ì»¬ëŸ¼ì„ ë§Œë“¤ì–´ì„œ êµ¬í•´ì˜¨ë‹¤. ì¥ì   ì •ê·œí™”ë„ ë˜ì–´ìˆê³ , ì œì•½ì¡°ê±´ì„ ë¶€ëª¨ì— ê±¸ì–´ ë§ì¶œ ìˆ˜ ìˆë‹¤.  ex: Order í…Œì´ë¸”ì—ì„œ íŠ¹ì • ì•„ì´í…œ(ì˜í™”)ì˜ ê°€ê²©ì„ ë³¼ ë•Œ ITEM í…Œì´ë¸”ë§Œ ë´ë„ ëœë‹¤.   ì €ì¥ê³µê°„ íš¨ìœ¨í™”   ë‹¨ì   ì¡°íšŒì‹œ ì¡°ì¸ì´ ë§ì„ ê²½ìš° ì„±ëŠ¥ ì €í•˜ ì¡°íšŒ ì¿¼ë¦¬ê°€ ë³µì¡í•¨ ë°ì´í„° ì €ì¥ì‹œ INSERT SQL 2ë²ˆ í˜¸ì¶œ(í° ë¬¸ì œëŠ” ì•„ë‹˜)   ì¡°ì¸ì´ ë§ì•„ë„ ì¡°ê±´ì´ ì˜ ê±¸ë ¤ìˆì„ ê²½ìš° ì„±ëŠ¥ í•˜ë½ì´ í¬ì§€ ì•Šê³  ì €ì¥ê³µê°„ì´ íš¨ìœ¨ì ìœ¼ë¡œ ë˜ê¸°ì— ì˜¤íˆë ¤ ë” ì¢‹ì„ ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ê³ ë ¤í•´ì•¼ í•œë‹¤.  2. ë‹¨ì¼ í…Œì´ë¸” ì „ëµ (default)  ë…¼ë¦¬ëª¨ë¸ì„ í•œ í…Œì´ë¸”ë¡œ í•©ì³ë²„ë¦¬ëŠ” ë°©ë²• í•œ í…Œì´ë¸”ì— ë‹¤ ë„£ì–´ ë†“ê³  ì–´ë–¤ í…Œì´ë¸”ì¸ì§€ êµ¬ë¶„í•˜ëŠ” ì»¬ëŸ¼(ex:DTYPE)ì„ í†µí•´ êµ¬ë¶„í•œë‹¤. í…Œì´ë¸”ì€ ITEM í…Œì´ë¸” í•˜ë‚˜ë§Œ ê´€ë¦¬ëœë‹¤. ì„±ëŠ¥ì—ì„œ ìš°ìœ„ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. (select or insertê°€ í•œë²ˆì— ìˆ˜í–‰ìœ¼ë¡œ ëœë‹¤.) @DiscriminatorColumn ì´ í•„ìˆ˜ë¡œ ë“¤ì–´ê°„ë‹¤(ê¸°ì…í•˜ì§€ ì•Šì•„ë„ ìë™ìœ¼ë¡œ ë“¤ì–´ê°) ì¥ì   ì¡°ì¸ì´ í•„ìš” ì—†ê¸°ì— ì¼ë°˜ì ìœ¼ë¡œ ì¡°íšŒ ì„±ëŠ¥ì´ ë¹ ë¦„ ì¡°íšŒ ì¿¼ë¦¬ê°€ ë‹¨ìˆœí•¨   ë‹¨ì   ìì‹ ì—”í‹°í‹°ê°€ ë§¤í•‘í•œ ì»¬ëŸ¼ì€ ëª¨ë‘ nullable í•´ì•¼ í•œë‹¤. ë‹¨ì¼ í…Œì´ë¸”ì— ëª¨ë“  ê²ƒì„ ì €ì¥í•˜ê¸°ì— í…Œì´ë¸”ì´ ì»¤ì§ˆ ìˆ˜ ìˆê³  ìƒí™©ì— ë”°ë¼ì„œ ì¡°íšŒì„±ëŠ¥ì´ ë” ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤. (ì„ê³„ì ì„ ë„˜ì„ ì €ë„ì˜ ìƒí™©ì€ ê±°ì˜ ì˜¤ì§€ ì•ŠëŠ”ë‹¤.)    3. êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ  ê°ê°ì˜ í…Œì´ë¸”ë§ˆë‹¤ ë³„ê°œë¡œ ë§Œë“¤ì–´ì„œ ë”°ë¡œ ê´€ë¦¬ ITEM í…Œì´ë¸”ì„ ìƒì„±í•˜ì§€ ì•Šê³  ALBUM, MOVIE, BOOK í…Œì´ë¸”ì—ì„œ ê°ê° id, name, price í•„ë“œë¥¼ ê°€ì§€ê³  ìˆë‹¤. @DiscriminatorColumnì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. (êµ¬ë¶„í•  ì´ìœ ê°€ ì—†ë‹¤.) ITEMì„ ì¡°íšŒí•˜ë©´ ALBUM, MOVIE, BOOK ì„¸ê°œì˜ í…Œì´ë¸”ì„ UNION ALLìœ¼ë¡œ ì „ë¶€ ì¡°íšŒí•´ì„œ ê°€ì ¸ì˜¨ë‹¤. (ë‹¨ì ) ì¶”ì²œí•˜ì§€ ì•ŠëŠ” ì „ëµ (ê°œë°œì, DBA ì–‘ì¸¡ì—ì„œ) ì¥ì   ì„œë¸Œ íƒ€ì…ì„ ëª…í™•í•˜ê²Œ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬í•  ë•Œ íš¨ê³¼ì  Not Null ì œì•½ì¡°ê±´ ê°€ëŠ¥   ë‹¨ì   ì—¬ëŸ¬ ìì‹ í…Œì´ë¸”ì„ í•¨ê»˜ ì¡°íšŒí•  ë•Œ ì„±ëŠ¥ì´ ëŠë¦¼ (UNION SQL) ìì‹ í…Œì´ë¸”ì„ í†µí•©í•´ì„œ ì¿¼ë¦¬í•˜ê¸° í˜ë“¬    2. ì£¼ìš” ì–´ë…¸í…Œì´ì…˜ @Inheritance(strategy = InheritanceType.XXX)
 JOINED : ì¡°ì¸ì „ëµ SINGLE_TABLE : ë‹¨ì¼ í…Œì´ë¸” ì „ëµ TABLE_PER_CLASS : êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ  @DiscriminatorColumn(name = &ldquo;DTYPE&rdquo;)
 default : DTYPE ì´ë¼ëŠ” Columnì´ super classì˜ tableì— ìƒê¸°ê³ , DTYPEì˜ ê°’ì€ sub classì˜ ì´ë¦„ìœ¼ë¡œ ì§€ì •ëœë‹¤. SingleTable ì „ëµì—ì„œ ì—†ì–´ë„ DTYPEì´ ìƒì„±ë˜ê¸°ë„ í•˜ëŠ”ë°, ê·¸ë˜ë„ ìš´ì˜ìƒ ì¨ì£¼ì. ì´ ì–´ë…¸í…Œì´ì…˜ì€ ìƒìœ„ í´ë˜ìŠ¤(Item)ì—ì„œ ëª…ì‹œëœë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒìœ„ í…Œì´ë¸”(Item í…Œì´ë¸”)ì—ê²Œ êµ¬ë¶„ì ì—­í• ì„ DTYPE ì¹¼ëŸ¼ì„ ë„£ì–´ì¤€ë‹¤. ì• ë…¸í…Œì´ì…˜ì˜ name ì†ì„±ìœ¼ë¡œ ì»¬ëŸ¼ëª…ì„ ë°”ê¿”ì¤„ ìˆ˜ ìˆë‹¤ (ì´ë¦„ì†ì„±ìœ¼ë¡œ ì“°ì).  @DiscriminatorValue(â€œXXXâ€)
 ì´ ì–´ë…¸í…Œì´ì…˜ì€ í•˜ìœ„ í´ë˜ìŠ¤(ALBUM, MOVIE, BOOK)ì—ì„œ ì‚¬ìš©ëœë‹¤. ìƒìœ„ í…Œì´ë¸”(ITEM í…Œì´ë¸”)ì„ ì¡°íšŒí• ë•Œ DTYPE ì¹¼ëŸ¼ì— ì‚¬ìš©ë˜ëŠ” valueë¥¼ ì„¤ì •í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ë‹¤. ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš° ê¸°ë³¸ Default ê°’ì¸ Entity ì´ë¦„ìœ¼ë¡œ valueê°’ì´ ì±„ì›Œì§€ê²Œ ëœë‹¤. default: classname  3. @MappedSuperclass   ê³µí†µ ë§¤í•‘ ì •ë³´ê°€ í•„ìš”í•  ë•Œ ì‚¬ìš©(id, name)  ex: ëª¨ë“  í…Œì´ë¸”ì— row ìƒì„±ì¼, ìˆ˜ì •ì¼ì„ ë“±ë¡í•´ì•¼í•˜ëŠ” ê²½ìš°(createdAt, updatedAt)     ìƒì†ê´€ê³„ ë§¤í•‘ì´ ì•„ë‹ˆë‹¤. ì—”í‹°í‹°ë„ ì•„ë‹ˆê³ , í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ì§€ë„ ì•ŠëŠ”ë‹¤. ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” ìì‹ í´ë˜ìŠ¤ì— ë§¤í•‘ ì •ë³´ë§Œ ì œê³µ ë¶€ëª¨íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ, ê²€ìƒ‰ ë¶ˆê°€ ì§ì ‘ ìƒì„±í•´ì„œ ì‚¬ìš©í•  ì¼ì´ ì—†ìœ¼ë¯€ë¡œ ì¶”ìƒí´ë˜ìŠ¤ ì¶”ì²œ  @Entityí´ë˜ìŠ¤ëŠ” ì—”í‹°í‹°ë‚˜ @MappedSuperclassë¡œ ì§€ì •í•œ í´ë˜ìŠ¤ë§Œ ìƒì† ê°€ëŠ¥
@MappedSuperclass public abstract class BaseEntity { private String createdBy; private LocalDateTime createdDate; private String modifiedBy; private LocalDateTime lastModifiedDate; } @Entity public class Member extends BaseEntity { } @Entity public class Team extends BaseEntity { } Member member = new Member(); member.]]></description>
</item><item>
    <title>ë‹¤ì–‘í•œ ì—°ê´€ê´€ê³„ ë§¤í•‘</title>
    <link>https://jaeyeonme.github.io/posts/jpa-mapping-various-associations/</link>
    <pubDate>Wed, 29 Dec 2021 13:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-mapping-various-associations/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ì—°ê´€ê´€ê³„ ë§¤í•‘ì‹œ ê³ ë ¤ì‚¬í•­ 3ê°€ì§€   ë‹¤ì¤‘ì„±  ë‹¤ëŒ€ì¼ : @ManyToOne ì¼ëŒ€ë‹¤ : @OneToMany ì¼ëŒ€ì¼ : @OneToOne ë‹¤ëŒ€ë‹¤ : @ManyToMany â†’ ë‹¤ëŒ€ë‹¤ëŠ” ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤. ë‹¨ë°©í–¥, ì–‘ë°©í–¥  í…Œì´ë¸”  ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ ì–‘ìª½ ì¡°ì¸ ê°€ëŠ¥ ë°©í–¥ì´ë¼ëŠ” ê°œë…ì´ ì—†ìŒ ì–‘ìª½ì´ ì„œë¡œ ì°¸ì¡°í•˜ë©´ ì–‘ë°©í–¥       ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸  í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ ë‘ ë°ì´ë¸”ì˜ ì—°ê´€ê´€ê³„ë¥¼ ì°¾ìŒ ê°ì²´ ì•¼ë°©í–¥ ê´€ê³„ëŠ” A â†’ B, B â†’ A ì²˜ëŸ¼ ì°¸ì¡°ê°€ 2êµ°ë° ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸: ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ì°¸ì¡° ì£¼ì¸ì˜ ë°˜ëŒ€í¸ : ì™¸ë˜ í‚¤ì— ì˜í–¥ì„ ì£¼ì§€ì•Šê³  ë‹¨ìˆœ ì¡°íšŒ(ì°¸ì¡°)ë§Œ ê°€ëŠ¥    2. ë‹¤ëŒ€ì¼ [N:1]  ë‹¤ëŒ€ì¼(N:1) ë‹¨ë°©í–¥   ERD
ë‹¤ëŒ€ì¼(N:1)ë‹¨ë°©í–¥
 ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ì—°ê´€ê´€ê³„ ë‹¤ëŒ€ì¼ì˜ ë°˜ëŒ€ëŠ” ì¼ëŒ€ë‹¤    ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥   ERD
 ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ìª½ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ ì–‘ìª½ì„ ì„œë¡œ ì°¸ì¡°í•˜ë„ë¡ ê°œë°œ ì—°ê´€ê´€ê³„ê°€ ì£¼ì¸ì´ ì•„ë‹Œ ìª½ì€ ë‹¨ìˆœ ì¡°íšŒë§Œ ê°€ëŠ¥í•˜ê¸°ì— í•„ë“œë§Œ ì¶”ê°€í•´ì£¼ë©´ ëœë‹¤.  @OneToMany private List&lt;Member&gt; members = new ArrayList&lt;&gt;();   3. ì¼ëŒ€ë‹¤ [1:N]  ì¼(One)ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤. â†’ ê¶Œì¥í•˜ëŠ” ë°©ë²•ì€ ì•„ë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œë„ ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
  ERD
 í…Œì´ë¸” ì¼ëŒ€ë‹¤ ê´€ê³„ëŠ” í•­ìƒ ë‹¤(N) ìª½ì— ì™¸ë˜ í‚¤ê°€ ìˆë‹¤. ê°ì²´ì™€ í…Œì´ë¸”ì˜ ì°¨ì´ ë–„ë¬¸ì— ë°˜ëŒ€í¸ í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•˜ëŠ” íŠ¹ì´í•œ êµ¬ì¡°    ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ì´ìœ    í…Œì´ë¸”ì—ì„œëŠ” í•­ìƒ ë‹¤(N) ìª½ì— ì™¸ë˜í‚¤ê°€ ìˆê¸° ë•Œë¬¸ì— íŒ¨ëŸ¬ë‹¤ì„ì¶©ëŒì´ ìˆë‹¤.
  @JoinColumn ì„ ê¼­ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì¡°ì¸ í…Œì´ë¸” ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. (ì¤‘ê°„ì— í…Œì´ë¸”ì„ í•˜ë‚˜ ì¶”ê°€í•¨)
  ì‹¤ë¬´ì—ì„œëŠ” í…Œì´ë¸”ì´ ìˆ˜ì‹­ê°œ ì´ìƒ ìš´ì˜ì´ ë˜ëŠ”ë°, ê´€ë¦¬ ë° íŠ¸ë ˆì´ì‹±ì´ ì–´ë µë‹¤.
â†’ Ex) ì¼ëŒ€ë‹¤(1:N)ì—ì„œ ì €ì¥(save)ì´ ë  ë•Œ ì–‘ìª½ ê°ì²´ë¥¼ ì €ì¥í•œ ë’¤ update queryë¥¼ í†µí•´ ì™¸ë˜í‚¤ ì„¤ì •(3ë²ˆì´ë‚˜ ìˆ˜í–‰)
   ê²°ë¡ : ê¸°ë³¸ì€ ë‹¤ëŒ€ì¼(N:1)ë¡œ êµ¬í˜„í•˜ë‹¤ í•„ì˜¤ì— ì˜í•´ ì–‘ë°©í–¥ ë‹¤ëŒ€ì¼(N:1) ê´€ê³„ë¥¼ ìˆ˜ë¦½í•˜ë„ë¡ í•˜ì.
 ì¼ëŒ€ë‹¤(1:N)ì–‘ë°©í–¥   ERD
  ì´ëŸ° ë§¤í•‘ì€ ê³µì‹ì ìœ¼ë¡œëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
  @JoinColumn(insertable=false, updatable=false)
/* íŒ€(Team) */ public class Team{ ... @OneToMany @JoinColumn(name=&#34;TEAM_ID&#34;) private List&lt;Member&gt; members = new ArrayList&lt;&gt;(); ... } /* ë©¤ë²„(Member) */ public class Member{ ... @ManyToOne @JoinColumn(name=&#34;TEAM_ID&#34;, insertable=false, updatable=false) private Team team; ... } â†’ Member ENtityì˜ team fieldê°€ ì½ê¸°ì „ìš© fieldê°€ ëë‹¤.
     ì½ê¸° ì „ìš© í•„ë“œë¥¼ ì‚¬ìš©í•´ì„œ ì–‘ë°©í–¥ ì²˜ëŸ¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²• ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ì„ ì‚¬ìš©í•˜ì.  4. ì¼ëŒ€ì¼(1:1)   ì£¼ í…Œì´ë¸”ì´ë‚˜ ëŒ€ìƒ í…Œì´ë¸” ì¤‘ì— ì™¸ë˜ í‚¤ ì„ íƒ ê°€ëŠ¥ ì™¸ë˜í‚¤ì— ë°ì´í„°ë² ì´ìŠ¤ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ ì¶”ê°€ ë‹¤ëŒ€ì¼ ì—°ê´€ê´€ê³„ì™€ ë™ì¼í•˜ê²Œ ì™¸ë˜í‚¤ê°€ ìˆëŠ”ê³³ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì— mappedByë¥¼ ë„£ì–´ì¤€ë‹¤. ì •ë¦¬  ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤  ì£¼ ê°ì²´ê°€ ëŒ€ìƒ ê°ì²´ì˜ ì°¸ì¡°ë¥¼ ê°€ì§€ëŠ” ê²ƒì²˜ëŸ¼ ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ë¥¼ ë‘ê³  ëŒ€ìƒ í…Œì´ë¸”ì„ ì°¾ìŒ ê°ì²´ì§€í–¥ ê°œë°œì ì„ í˜¸ JPA ë§¤í•‘ ì •ë¦¬ ì¥ì  : ì£¼ í…Œì´ë¸”ë§Œ ì¡°íšŒí•´ë„ ëŒ€ìƒ í…Œì´ë¸”ì— ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸ ê°€ëŠ¥ ë‹¨ì  : ê°’ì´ ì—†ìœ¼ë©´ ì™¸ë˜ í‚¤ì— null í—ˆìš©   ëŒ€ìƒ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤  ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ì¡´ì¬ ì „í†µì ì¸ ë°ì´í„°ë² ì´ìŠ¤ ê°œë°œì ì„ í˜¸ ì¥ì  : ì£¼ í…Œì´ë¸”ê³¼ ëŒ€ìƒ í…Œì´ë¸”ì„ ì¼ëŒ€ì¼ì—ì„œ ì¼ëŒ€ë‹¤ ê´€ê³„ë¡œ ë³€ê²½í•  ë•Œ í…Œì´ë¸” êµ¬ì¡° ìœ ì§€ ë‹¨ì  : ì£¼ í…Œì´ë¸”ì—ëŠ” ì™¸ë˜ í‚¤ê°€ ì—†ê¸° ë•Œë¬¸ì— ëŒ€ìƒ í…Œì´ë¸”ì´ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì¦‰ì‹œë¡œë”©ì´ ë¬´ì¡°ê±´ ëœë‹¤.      5. ë‹¤ëŒ€ë‹¤ [N:M]   ì‹¤ë¬´ì—ì„œëŠ” ê±°ìœ¼ ã…£ì‚¬ìš©í•˜ì§€ë„ ì•Šê³  ì¶”ì²œí•˜ì§€ë„ ì•ŠëŠ” ì—°ê´€ê´€ê³„ ê°ì²´ëŠ” ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•´ì„œ ê°ì²´ 2ê°œë¡œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ ê°€ëŠ¥ @ManyToMany ì‚¬ìš© @JoinTableë¡œ ì—°ê²° í…Œì´ë¸” ì§€ì •  ë‹¤ëŒ€ë‹¤ ë§¤í•‘ì˜ í•œê³„  í¸ë¦¬í•´ ë³´ì´ì§€ë§Œ ì‹¤ë¬´ì—ì„œ ì‚¬ìš©ì•ˆí•¨ ì—°ê²µ í…Œì´ë¸”ì´ ë‹¨ìˆœíˆ ì—°ê²°ë§Œ í•˜ê³  ëë‚˜ì§€ ì•ŠìŒ ì£¼ë¬¸ì‹œê°„, ìˆ˜ëŸ‰ ê°™ì€ ë°ì´í„°ê°€ ë“¤ì–´ì˜¬ ìˆ˜ ìˆìŒ.]]></description>
</item><item>
    <title>ì—°ê´€ê´€ê³„ ë§¤í•‘ ê¸°ì´ˆ</title>
    <link>https://jaeyeonme.github.io/posts/jpa-mapping-basics/</link>
    <pubDate>Wed, 29 Dec 2021 12:50:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-mapping-basics/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ì—°ê´€ê´€ê³„ì˜ í•„ìš”ì„±  : ê°ì²´ì§€í–¥ ì„¤ê³„ì˜ ëª©í‘œëŠ” ììœ¨ì ì¸ ê°ì²´ë“¤ì˜ í˜‘ë ¥ ê³µë™ì²´ë¥¼ ë§Œë“œëŠ” ê²ƒì´ë‹¤.
2. ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶° ë°ì´í„° ì¤‘ì‹¬ìœ¼ë¡œ ëª¨ë¸ë§í•˜ë©´, í˜‘ë ¥ ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤. 2-1. ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§(ì—°ê´€ê´€ê³„ê°€ ì—†ëŠ” ê°ì²´)   ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§ (ì°¸ì¡° ëŒ€ì‹ ì— ì™¸ë˜ í‚¤ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
/* íšŒì›(Member) ì—”í‹°í‹°*/ @Entity public class Member { @Id @GeneratedValue private Long id; @Column(name = &#34;USERNAME&#34;) private String name; @Column(name = &#34;TEAM_ID&#34;) private Long teamId; } /* íŒ€(Team) ì—”í‹°í‹° */ @Entity public class Team{ @Id @GeneratedValue private Long id; private String name; }  ê°ì²´ë¥¼ ìœ„ì™€ ê°™ì´ í…Œì´ë¸”ì— ë§ì¶° ëª¨ë¸ë§ì„ í•  ê²½ìš° ìƒê¸°ëŠ” ë¬¸ì œëŠ” ë¬´ì—‡ì¼ê¹Œ?      ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶° ëª¨ë¸ë§ í–ˆì„ ê²½ìš° DBì— ì €ì¥&amp;ì¡°íšŒí•˜ëŠ” ë¡œì§
/* íŒ€ê³¼ ë©¤ë²„ë¥¼ ì €ì¥í•˜ëŠ” ë¡œì§ */ Team team = new Team(); team.setName(&#34;teamA&#34;); em.persist(team); Member member = new Member(); member.setName(&#34;mamber1&#34;); member.setTeamId(team.getId()); em.persist(member);  ì™¸ë˜í‚¤ ì‹ë³„ìë¥¼ ì§ì ‘ë‹¤ë£¨ê³  ìˆëŠ”ë°, ì´ëŸ´ ê²½ìš° ë¬¸ì œëŠ”? â†’ ì¡°íšŒí•  ë•Œ ì—­ì‹œ í•´ë‹¹ ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ì¡°ì¸ ì¿¼ë¦¬ë¥¼ ì§ì ‘ ì§œì•¼ í•œë‹¤. Q. member1 ì´ ì†Œì†ëœ íŒ€ ì •ë³´ë¥¼ ì¡°íšŒí•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í•˜ëŠ”ê°€?  Member findMember = em.find(Member.class, member.getId()); Long findTeamId = findMember.getTeamId(); Team findTeam = em.find(Team.class, findTeamId);  ë§¤ë²ˆ memberë¥¼ ìš°ì„  ì¡°íšŒí•œ ë’¤ ì™¸ë˜í‚¤ë¥¼ ë½‘ì•„ ê·¸ê²ƒìœ¼ë¡œ íŒ€ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•´ì•¼ í•œë‹¤. â†’ í˜‘ë ¥ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤.    Hibernate: create table Member ( MEMBER_ID bigint not null, TEAM_ID bigint, USERNAME varchar(255), primary key (MEMBER_ID) ) Hibernate: create table Team ( TEAM_ID bigint not null, name varchar(255), primary key (TEAM_ID) )  ê²°ë¡ : ì™¸ë˜í‚¤ë¥¼ ì§ì ‘ ê´€ë¦¬í•˜ëŠ” í…Œì´ë¸”ì— ë§ì¶˜ ê°ì²´ ëª¨ë¸ë§ì€ ê°ì²´ê°„ì˜ í˜‘ë ¥ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ê³ , ê°ì²´ê°€ ì°¸ì¡°ë¥¼ í†µí•´ ì—°ê´€ê°ì²´ë¥¼ ì°¾ëŠ” ë‹¤ëŠ” ì‚¬ìƒì„ ì ìš©í•  ìˆ˜ ì—†ë‹¤. ì´ ë§ì€ ê°ì²´ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì˜ íŒ¨ëŸ¬ë‹¤ì„ì„ ì •ë©´ìœ¼ë¡œ ë°˜ë°•í•˜ëŠ” ê²ƒ.
  ê°ì²´ ì§€í–¥ ëª¨ë¸ë§ (ê°ì²´ ì—°ê´€ê´€ê³„ ì‚¬ìš©)
   ê°ì²´ ì§€í–¥ì ìœ¼ë¡œ ì—”í‹°í‹° ì„¤ê³„(ê°ì²´ ì—°ê´€ê´€ê³„ ì‚¬ìš©)
/* íšŒì›(Member) ì—”í‹°í‹°*/ @Entity public class Member { @Id @GeneratedValue private Long id; @Column(name = &#34;USERNAME&#34;) private String name; @ManyToOne @JoinColumn(name = &#34;team_id&#34;) private Team team; ... getter, setter }  @ManyToOne @JoinColumn ì„ í†µí•´ ë©¤ë²„(Member)ì—ì„œ íŒ€(Team)ì„ ì°¸ì¡°í•˜ë„ë¡ í—€ë‹¤.    Team team = new Team(); team.setName(&#34;teamA&#34;); em.persist(team); Member member = new Member(); member.setName(&#34;mamber1&#34;); member.setTeam(team); em.persist(member); em.flush(); em.clear(); Member findMember = em.find(Member.class, member.getId()); Team findTeam = member.getTeam(); 
3. ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì™€ ì—°ê´€ê´€ê³„ ì£¼ì¸1 - ê¸°ë³¸    ë‹¨ë°©í–¥ì—ì„œ ì–‘ë°©í–¥ì´ ëœë‹¤ëŠ” ê²ƒì˜ ì˜ë¯¸ëŠ” ì–‘ì¸¡ì—ì„œ ì„œë¡œ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ê¸°ì¡´ ë‹¨ë°©í–¥ì—ì„œëŠ” Member ì—ì„œ getTeam()ì„ í†µí•´ Team ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆì§€ë§Œ Team ì—ì„œëŠ” Member ë¥¼ ì°¸ì¡°í•  ìˆ˜ ì—†ì—ˆë‹¤. í•˜ì§€ë§Œ í…Œì´ë¸” ì—°ê´€ê´€ê³„ì—ì„œëŠ” ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ì–‘ì¸¡ì—ì„œ ì„œë¡œë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤.
  Team ê°ì²´ì— membersë¼ëŠ” Listë¥¼ ì¶”ê°€í•´ì„œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.
@Entity public class Team{ ... @OneToMany(mappedBy = &#34;team&#34;) private List&lt;Member&gt; members = new ArrayList&lt;&gt;(); ... }     ì¶”ê°€í•œ members ë¥¼ í™•ì¸í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì.
Member findMember = em.find(Member.class, member.getId()); List&lt;Member&gt; members = findMember.getTeam().getMembers(); for (Member member1 : members) { System.out.println(&#34;member1.getName() = &#34; + member1.getName()); // member1.getName() = mamber1 }  ì´ì œ ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œë„ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ì´ ê°€ëŠ¥í•´ì¡Œë‹¤.    ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ê³¼ mappedBy  mappedBy = ì—°ê´€ê´€ê³„ì˜ ê°œë…ì— ëŒ€í•´ ì´í•´ë¥¼ ì–´ë µê²Œ ë§Œë“œëŠ” ì£¼ë²”! ê°ì²´ì™€ í…Œì´ë¸”ê°„ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” ì°¨ì´ë¥¼ ì´í•´í•´ì•¼ í•œë‹¤.  ê°ì²´ì™€ í…Œì´ë¸”ì´ ê´€ê³„ë¥¼ ë§ºëŠ” ì°¨ì´ë€?  ê°ì²´ ì—°ê´€ê´€ê³„ = 2ê°œ  íšŒì› â†’ íŒ€ ì—°ê´€ê´€ê³„ 1ê°œ(ë‹¨ë°©í–¥) íŒ€ â†’ íšŒì› ì—°ê´€ê´€ê³„ 1ê°œ(ë‹¨ë°©í–¥)   í…Œì´ë¸” ì—°ê´€ê´€ê³„ = 1ê°œ  íšŒì› â†â†’ íŒ€ì˜ ì—°ê´€ê´€ê³„ 1ê°œ(ì–‘ë°©í–¥)    ê²°êµ­ ì–‘ë°©í–¥ ê´€ê³„ë€  ê°ì²´ì˜ ì–‘ë°©í–¥ ê´€ê³„ëŠ” ì‚¬ì‹¤ ì–‘ë°©í–¥ ê´€ê³„ê°€ ì•„ë‹ˆë¼ ì„œë¡œ ë‹¤ë¥¸ ë‹¨ë°©í–¥ ê´€ê³„ 2ê°œë‹¤.]]></description>
</item><item>
    <title>ì—”í‹°í‹°ë§¤í•‘</title>
    <link>https://jaeyeonme.github.io/posts/jpa-entity-mapping/</link>
    <pubDate>Wed, 29 Dec 2021 12:10:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-entity-mapping/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>ì—”í‹°í‹° ë§¤í•‘ ì†Œê°œ   ê°ì²´ì™€ í…Œì´ë¸” ë§¤í•‘ : @Entity , @Table í•„ë“œì™€ ì»¬ëŸ¼ ë§¤í•‘ : @Column ê¸°ë³¸ í‚¤ ë§¤í•‘ : @Id ì—°ê´€ê´€ê³„ ë§¤í•‘ : @ManyToOne , @JoinColumn  JPAë¡œ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ìë™ ìƒì„±í•˜ëŠ” ë°©ë²• JPAë¡œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë¡œë”© ì‹œì ì— í…Œì´ë¸”ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ì¼ì¼ì´ ìŠ¤í‚¤ë§ˆë¥¼ ìˆ˜ì •í•˜ê¸° í˜ë“ Â ê°œë°œ í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤. ìš´ì˜ì—ì„œ ì“°ë ¤ë©´ ì ˆëŒ€ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ì„œ ì•ˆ ë˜ê³  ë‹¤ë“¬ì–´ì•¼ í•œë‹¤.
ì—”í‹°í‹° ë§¤í•‘ì„ í•´ë†“ìœ¼ë©´, JPAê°€ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì— DDLì„ ìë™ ìƒì„±í•˜ì—¬ ìˆ˜í–‰í•œë‹¤. ê°ì²´ ì¤‘ì‹¬ìœ¼ë¡œ ê°œë°œí•´ ë†“ê¸°ë§Œ í•˜ë©´ ë˜ë‹ˆ í…Œì´ë¸”ì„ ê±´ë“œë¦´ í•„ìš” ì—†ë‹¤. ê²Œë‹¤ê°€ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸(dialect)ë¥¼ í™œìš©í•´ DBì— ì•Œë§ëŠ” DDLì„ ë§Œë“ ë‹¤.
ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„  spring.jpa.hibernate.ddl-auto ì†ì„±ìœ¼ë¡œ ìŠ¤í‚¤ë§ˆ ìƒì„± ì „ëµì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
  create : ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ í›„ ë‹¤ì‹œ ìƒì„± (DROP -&gt; CREATE)
  create-drop : create + ì¢…ë£Œ ì‹œì  drop (DROP -&gt; CREATE -&gt; DROP)
  update : ì¶”ê°€ëœ ì‚¬í•­ë§Œ ë°˜ì˜, ì´ë¯¸ ë°˜ì˜ëœ ê²ƒì„ ì§€ìš°ëŠ” ì‘ì—…ì€ ë¶ˆê°€ëŠ¥! (íŠ¹íˆ ìš´ì˜DBì—ì„œ ì‚¬ìš©í•˜ë©´ ì•ˆ ë¨)
  validate : ì—”í‹°í‹°ì™€ í…Œì´ë¸”ì´ ì•Œë§ê²Œ ë§¤í•‘ë˜ì—ˆëŠ”ì§€ ê²€ì¦
  none : ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
  ë¡œì»¬ ì„œë²„ì—ì„œ ììœ ë¡­ê²Œ ì‚¬ìš©í•˜ê³ , ì—¬ëŸ¬ ëª…ì˜ ê°œë°œìê°€ ì‚¬ìš©í•˜ëŠ” ì„œë²„ì—ì„  ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²Œ ì¢‹ë‹¤.
create / create-dropì€ ê¸°ì¡´ í…Œì´ë¸”ì„ ë“œëí•˜ê¸° ë•Œë¬¸ì— ê¸°ì¡´ ë°ì´í„°ë¥¼ ë‚ ë ¤ë²„ë¦¬ê³ , updateëŠ” alterë¬¸ì„ ì‹¤í–‰í•˜ë©´ì„œ í…Œì´ë¸” lockì„ ê±¸ê¸° ë•Œë¬¸ì— ì¡°ì‹¬í•´ì•¼ í•œë‹¤.
ì‹¤ë¬´ì—ì„œëŠ” validate ë¥¼ ì‚¬ìš©
1. ê°ì²´ì™€ í…Œì´ë¸” ë§¤í•‘ @Entity   @Entityê°€ ë¶™ì€ í´ë˜ìŠ¤ëŠ” JPAê°€ ê´€ë¦¬, ì—”í‹°í‹°ë¼ í•œë‹¤. JPAë¥¼ ì‚¬ìš©í•´ì„œ í…Œì´ë¸”ê³¼ ë§¤í•‘í•  í´ë˜ìŠ¤ëŠ” @Entity í•„ìˆ˜ ì£¼ì˜  ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜ (íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” public ë˜ëŠ” protected ìƒì„±ì) final í´ë˜ìŠ¤, enum, interface, inner í´ë˜ìŠ¤ ì‚¬ìš©X ì €ì¥í•  í•„ë“œì— final ì‚¬ìš©X    @Entity ì†ì„± ì •ë¦¬   ì†ì„± : name  JPAì—ì„œ ì‚¬ìš©í•  ì—”í‹°í‹° ì´ë¦„ì„ ì§€ì •í•œë‹¤. ê¸°ë³¸ê°’ : í´ë˜ìŠ¤ ì´ë¦„ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš© (ì˜ˆ: Member) ê°™ì€ í´ë˜ìŠ¤ ì´ë¦„ì´ ì—†ìœ¼ë©´ ê°€ê¸‰ì  ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•œë‹¤.    ì£¼ì˜í•  ì 
 ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜ (public or protected) final í´ë˜ìŠ¤ / inner í´ë˜ìŠ¤ / enum / interface ì—ëŠ” ì‚¬ìš© ë¶ˆê°€ëŠ¥ DB ì»¬ëŸ¼ê³¼ ë§¤í•‘ë  í•„ë“œì— final ì‚¬ìš© ë¶ˆê°€ëŠ¥  @Table   @Tableì€ ì—”í‹°í‹°ì™€ ë§¤í•‘í•  í…Œì´ë¸” ì§€ì •     ì†ì„± ê¸°ëŠ¥ ê¸°ë³¸ê°’     name ë§¤í•‘í•  í…Œì´ë¸” ì´ë¦„ ì—”í‹°í‹° ì´ë¦„ì„ ì‚¬ìš©   catalog ë°ì´í„°ë² ì´ìŠ¤ catalog ë§¤í•‘    schema ë°ì´í„°ë² ì´ìŠ¤ schema ë§¤í•‘    uniqueConstrints (DDL) DDL ìƒì„± ì‹œì— ìœ ë‹ˆí¬ ì œì•½ ì¡°ê±´ ìƒì„±     2. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±  ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±  DDLì„ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì— ìë™ ìƒì„± í…Œì´ë¸” ì¤‘ì‹¬ â†’ ê°ì²´ ì¤‘ì‹¬ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ì„ í™œìš©í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ë§ëŠ” ì ì ˆí•œ DDL ìƒì„± ì´ë ‡ê²Œ ìƒì„±ëœ DDLì€ ê°œë°œ ì¥ë¹„ì—ì„œë§Œ ì‚¬ìš© ìƒì„±ëœ DDLì€ ìš´ì˜ì„œë²„ì—ì„œëŠ” ì‚¬ìš©ë˜ì§€ ì•Šê±°ë‚˜ ì ì ˆíˆ ë‹¤ë“¬ì€ í›„ ì‚¬ìš©  ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„± - ì†ì„±  hibernate.hbm2ddl.auto  create : ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ í›„ ë‹¤ì‹œ ìƒì„± (DROP + CREATE) create-drop : createì™€ ê°™ìœ¼ë‚˜ ì¢…ë£Œì‹œì ì— í…Œì´ë¸” DROP update : ë³€ê²½ë¶„ë§Œ ë°˜ì˜ (ìš´ì˜DBì—ëŠ” ì‚¬ìš©í•˜ë©´ ì•ˆë¨) validate : ì—”í‹°í‹°ì™€ í…Œì´ë¸”ì´ ì •ìƒ ë§¤í•‘ë˜ì—ˆëŠ”ì§€ë§Œ í™•ì¸ none : ì‚¬ìš©í•˜ì§€ ì•ŠìŒ    DDL ìƒì„± ê¸°ëŠ¥  ì œì•½ì¡°ê±´ ì¶”ê°€ : íšŒì› ì´ë¦„ í•„ìˆ˜ , 10ì ì´ˆê³¼ X  @Column(nullable = false, length = 10)   ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ ì¶”ê°€  @Table(uniqueConstraints = {@UniqueCOnstraint(name = &quot;NAME_AGE_UNIQUE&quot;, columnNames = {&quot;NAME&quot;, &quot;AGE&quot;})})   DDL ìƒì„± ê¸°ëŠ¥ì€ DDLì„ ìë™ ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©ë˜ê³  JPAì˜ ì‹¤í–‰ ë¡œì§ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.]]></description>
</item><item>
    <title>ì˜ì†ì„±ê´€ë¦¬ - ë‚´ë¶€ ë™ì‘ ë°©ì‹</title>
    <link>https://jaeyeonme.github.io/posts/jpa-persistence-management-works/</link>
    <pubDate>Wed, 29 Dec 2021 12:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-persistence-management-works/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸  ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ êµ¬ë™í•˜ëŠ” ì‹œì ì— EntityManagerFactory ë¥¼ ìƒì„±í•˜ì—¬ ê°€ì§€ê³  ìˆìœ¼ë©°, ì‚¬ìš©ìì˜ ìš”ì²­ì´ ìˆì„ ë•Œ EntityManagerë¥¼ ìƒì„±í•˜ì—¬ ì»¤ë„¥ì…˜ í’€(Connection Pool)ì„ ì‚¬ìš©í•´ì„œ DBë¥¼ í•¸ë“¤ë§ í•˜ê²Œ ëœë‹¤.  ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë€?   ì—”í‹°í‹°ë¥¼ ì˜êµ¬ ì €ì¥í•˜ëŠ” í™˜ê²½
  EntityManager.persist(entity);
â†’ DBì— ì €ì¥í•œë‹¤ê¸° ë³´ë‹¤ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í†µí•´ ì—”í‹°í‹°ë¥¼ ì˜ì†í™” í•œë‹¤ëŠ” ì˜ë¯¸
 ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì—”í‹°í‹°ë¥¼ ì €ì¥í•œë‹¤ëŠ” ë§    ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ë…¼ë¦¬ì ì¸ ê°œë…
  ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.
  ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ í†µí•´ì„œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì ‘ê·¼
 J2SE í™˜ê²½    ì—”í‹°í‹°ì˜ ìƒëª… ì£¼ê¸°  ë¹„ì˜ì†(new / transient): ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì „í˜€ ê´€ê³„ê°€ ì—†ëŠ” ìƒˆë¡œìš´ ìƒíƒœ ì˜ì†(managed): ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ê´€ë¦¬ë˜ëŠ” ìƒíƒœ ì¤€ì˜ì†(detached): ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥ë˜ì—ˆë‹¤ê°€ ë¶„ë¦¬ëœ ìƒíƒœ ì‚­ì œ(removed): ì‚­ì œëœ ìƒíƒœ  ë¹„ì˜ì† : JPAì— ê´€ê³„ì—†ì´ ê°ì²´ ìƒì„±ë§Œ ëœ ìƒíƒœ
// ê°ì²´ë¥¼ ìƒì„±í•œ ìƒíƒœ(ë¹„ì˜ì†) Member member = new Member(); member.setId(&#34;member1&#34;); member.setUsername(&#34;íšŒì›1&#34;); 
ì˜ì† // ê°ì²´ë¥¼ ìƒì„±í•œ ìƒíƒœ(ë¹„ì˜ì†) Member member = new Member(); member.setId(&#34;member1&#34;); member.setUsername(&#34;íšŒì›1&#34;); EntityManager em = emf.createEntityManager(); em.getTransaction().begin(); // ê°ì²´ë¥¼ ì €ì¥í•œ ìƒíƒœ(ì˜ì†) em.persist(member); 
ì¤€ì˜ì†, ì‚­ì œ // íšŒì› ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬, ì¤€ì˜ì† ìƒíƒœ em.detach(member); // ê°ì²´ë¥¼ ì‚­ì œí•œ ìƒíƒœ(ì‚­ì œ) em.remove(member);  ì¤€ì˜ì†: ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‚­ì œí•˜ëŠ” ê²ƒ ì‚­ì œëŠ” ì‹¤ì œë¡œ DBì—ì„œ í•´ë‹¹ ROWë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒ  2. ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ì´ì  1. 1ì°¨ ìºì‹œ Member member = new Member(); member.setId(&#34;member1&#34;); member.setUsername(&#34;íšŒì›1&#34;); //1ì°¨ ìºì‹œì— ì €ì¥ë¨ em.persist(member); //1ì°¨ ìºì‹œì—ì„œ ì¡°íšŒ Member findMember = em.find(Member.class, &#34;member1&#34;);  ì¡°íšŒ ì‹œ ì˜ì† ì»¨í…ìŠ¤íŠ¸ì•ˆì—ì„œ 1ì°¨ ìºì‹œë¥¼ ì¡°íšŒ í›„ í•´ë‹¹ ì—”í‹°í‹°ê°€ ìˆì„ ê²½ìš° ìºì‹œë¥¼ ì¡°íšŒ í•´ ì˜¨ë‹¤. ì¡°íšŒ ì‹œ ì˜ì† ì»¨í…ìŠ¤íŠ¸ ì•ˆì—ì„œ 1ì°¨ ìºì‹œë¥¼ ì¡°íšŒ í›„ í•´ë‹¹ ì—”í‹°í‹°ê°€ ì—†ì„ ê²½ìš° ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒí•´ ì˜¨ë‹¤. ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ ë‚´ë¶€ì—ì„œ ë§Œë“¤ê³  ì¢…ë£Œë˜ê¸° ë•Œë¬¸ì— í•˜ë‚˜ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ì¢…ë£Œë  ê²½ìš° 1ì°¨ìºì‹œëŠ” ë‹¤ ì‚¬ë¼ì§€ê¸° ë•Œë¬¸ì— í° ë„ì›€ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤. (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ë³µì¡í•´ ì§ˆ ìˆ˜ë¡ íš¨ê³¼ëŠ” ì»¤ì§„ë‹¤.)  2. ë™ì¼ì„±(identity) ë³´ì¥ Member findMember = em.find(Member.class, 100L); Member findMember2 = em.find(Member.class, 100L); System.out.println(findMember == findMember2); // true : 1ì°¨ ìºì‹œë¡œ ë°˜ë³µ ê°€ëŠ¥í•œ ì½ê¸°(REPEATABLE READ) ë“±ê¸‰ì˜ íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ ë°ì´í„°ë² ì´ìŠ¤ê°€ ì•„ë‹Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì°¨ì›ì—ì„œ ì œê³µ
 ì°¸ê³ : íŠ¸ëœì­ì…˜ì˜ ê²©ë¦¬ìˆ˜ì¤€ì´ ê¶ê¸ˆí•˜ë©´ íŠ¸ëœì­ì…˜ì´ ë³´ì¥í•´ì•¼ í•˜ëŠ” ACIDë¥¼ ê¸°ì–µí•˜ì.
 3. ì—”í‹°í‹° ë“±ë¡ - íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ì§€ì§€ì—° Member member = new Member(150L, &#34;A&#34;); Member member2 = new Member(160L, &#34;B&#34;); em.persist(member); em.persist(member2); // ì—”í‹°í‹° ë“±ë¡ì€ ì•„ì§ ìˆ˜í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤. (ì“°ì§€ ì§€ì—°)  System.out.println(&#34;=========&#34;); tx.commit(); // ì—í‹°í‹° ë“±ë¡ì€ ì´ ë–„ ë™ì‹œì— ìˆ˜í–‰ëœë‹¤. 
memberAì™€ memberrBëŠ” ë‘˜ ë‹¤ ì“°ê¸°ì§€ì—° SQLì €ì¥ì†Œì— ì €ì¥ë˜ì–´ìˆê³  ì‹¤ì œ DBì— ì ìš©ì€ ì•ˆëœ ìƒíƒœ
commit() ì‹œì ì— ì“°ê¸°ì§€ì—° SQLì— ì €ì¥ëœ ì¿¼ë¦¬ë“¤ì„ ë‹¤ ì‹¤í–‰ì‹œì¼œì„œ DBì— ì ìš©í•œë‹¤.
ì“°ê¸° ì§€ì—°ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ 
-&gt; ë²„í¼ë§ ê¸°ëŠ¥ì´ ì œê³µ
&lt;property name=&#34;hibernate.jdbc.batch_size&#34; value=&#34;10&#34;/&gt; -&gt; 10ê°œì”© ìŒ“ì¼ë•Œë§ˆë‹¤ ì ìš©í•˜ê²Œ í•˜ëŠ” ê¸°ëŠ¥
-&gt; ì¿¼ë¦¬ë¥¼ ì—¬ëŸ¬ë²ˆ ë‚ ë¦¬ì§€ ì•Šê³  ìµœì í™”ê°€ ê°€ëŠ¥í•˜ë‹¤.
4. ì—”í‹°í‹° ìˆ˜ì • - ë³€ê²½ê°ì§€(Dirty Checking) transaction.begin(); //ì—”í‹°í‹° ì¡°íšŒ Member findMember = em.find(Member.class, &#34;memberA&#34;); //ì˜ì† ì—”í‹°í‹° ë°ì´í„° ìˆ˜ì • findMember.setUsername(&#34;hi&#34;); findMember.setAge(10); transaction.commit(); â†’ 1ì°¨ ìºì‹œì•ˆì—ëŠ” @Id, Entity , ìŠ¤ëƒ…ìƒ· ì´ ìˆë‹¤. ì—¬ê¸°ì„œ ìŠ¤ëƒ…ìƒ· ì€ ìµœì´ˆë¡œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(1ì°¨ìºì‹œ)ì— ë“¤ì–´ì˜¤ëŠ”ìˆœê°„ ìŠ¤ëƒ…ìƒ·ì„ ì°ì–´ì„œ ì €ì¥í•´ë‘”ë‹¤.
â†’ JPAëŠ” íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹(commit)ë˜ëŠ” ìˆœê°„ ì—”í‹°í‹°ì™€ ìŠ¤ëƒ…ìƒ·ì„ ëª¨ë‘ ë¹„êµí•œë‹¤.
â†’ ë³€ê²½ëœ ê²ƒì´ ìˆì„ ê²½ìš° ì“°ê¸°ì§€ì—° SQL ì €ì¥ì†Œ ì— ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ë¥¼ ì €ì¥í•˜ê³  ìˆ˜í–‰í•˜ê²Œ ëœë‹¤.
5. ì—”í‹°í‹° ì‚­ì œ //ì‚­ì œ ëŒ€ìƒ ì—”í‹°í‹° ì¡°íšŒ Member member = em.find(Member.class, &#34;memberA&#34;); em.remove(member);//ì—”í‹°í‹° ì‚­ì œ 
3. í”ŒëŸ¬ì‹œ(flush) : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë³€ê²½ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜(sync)
  í”ŒëŸ¬ì‹œ ë°œìƒ
 ë³€ê²½ ê°ì§€ ìˆ˜ì •ëœ ì—”í‹°í‹° ì“°ê¸°ì§€ì—° SQL ì €ì¥ì†Œì— ë“±ë¡ ì“°ê¸° ì§€ì—° SQLì €ì¥ì†Œì˜ ì¿¼ë¦¬ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ì†¡(ë“±ë¡, ìˆ˜ì •, ì‚­ì œ ì¿¼ë¦¬)    ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”ŒëŸ¬ì‹œ í•˜ëŠ” ë°©ë²•]]></description>
</item></channel>
</rss>
