<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>QueryDSL - Category - ðŸ“š | Dev Blog</title>
        <link>https://jaeyeonme.github.io/categories/querydsl/</link>
        <description>QueryDSL - Category - ðŸ“š | Dev Blog</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Fri, 31 Dec 2021 13:00:00 &#43;0000</lastBuildDate><atom:link href="https://jaeyeonme.github.io/categories/querydsl/" rel="self" type="application/rss+xml" /><item>
    <title>QueryDSL ì¤‘ê¸‰ ë¬¸ë²•</title>
    <link>https://jaeyeonme.github.io/posts/querydsl-intermediate-grammer/</link>
    <pubDate>Fri, 31 Dec 2021 13:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/querydsl-intermediate-grammer/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/querydsl.png" referrerpolicy="no-referrer">
            </div>í”„ë¡œì ì…˜ê³¼ ê²°ê³¼ ë°˜í™˜ - ê¸°ë³¸ í”„ë¡œì ì…˜ : select ëŒ€ìƒ ì§€ì •
í”„ë¡œì ì…˜ ëŒ€ìƒì´ í•˜ë‚˜
List&lt;String&gt; result = queryFactory .select(member.username) .from(member) .fetch();  í”„ë¡œì ì…˜ ëŒ€ìƒì´ í•˜ë‚˜ë©´ íƒ€ìž…ì„ ëª…í™•í•˜ê²Œ ì§€ì •í•  ìˆ˜ ìžˆìŒ(List&lt;String&gt;) í”„ë¡œì ì…˜ ëŒ€ìƒì´ ë‘˜ ì´ìƒì´ë©´ íŠœí”Œì´ë‚˜ DTOë¡œ ì¡°íšŒ  íŠœí”Œ ì¡°íšŒ í”„ë¡œì ì…˜ ëŒ€ìƒì´ ë‘˜ ì´ìƒì¼ ë•Œ ì‚¬ìš©
com.querydsl.core.Tuple
List&lt;Tuple&gt; result = queryFactory .select(member.username, member.age) .from(member) .fetch(); for (Tuple tuple : result) { String username = tuple.get(member.username); Integer age = tuple.get(member.age); System.out.println(&#34;username = &#34; + username); System.out.println(&#34;age = &#34; + age); }  Tuple ì€ ë¦¬í¬ì§€í† ë¦¬ ê³„ì¸µì•ˆì—ì„œ ì“°ëŠ” ì •ë„ëŠ” ê´œì°®ì§€ë§Œ ê·¸ ë°–ì˜ ê³„ì¸µì—ì„œëŠ” DTOë¡œ ë³€í™˜í•´ì„œ ì“°ëŠ” ê²ƒì´ ì¢‹ë‹¤. â†’ Tuple ë„ ê²°êµ­ Querydslì— ì¢…ì†ì ì´ê¸° ë–„ë¬¸  í”„ë¡œì ì…˜ê³¼ ê²°ê³¼ ë°˜í™˜ - DTO ì¡°íšŒ ìˆœìˆ˜ JPAì—ì„œ DTO ì¡°íšŒ ìœ„ì—ì„œ select ì ˆì—ì„œ ëŒ€ìƒì„ ì§€ì •(í”„ë¡œì ì…˜)í•´ì„œ ê°€ì ¸ì˜¤ê³  ì‹¶ì„ë•Œ ê·¸ ëŒ€ìƒì´ ë‘˜ ì´ìƒì´ë©´ Tupleë¡œ ê°€ì ¸ì™”ì—ˆë‹¤. í•˜ì§€ë§Œ, ê·¸ ì™¸ ê³„ì¸µìœ¼ë¡œ ê°€ì ¸ê°ˆ ë•ŒëŠ” DTOë¡œ ê°€ì ¸ê°€ëŠ”ê²Œ ì¢‹ë‹¤. ìš°ì„  ìˆœìˆ˜ JPAë¥¼ ì´ìš©í•´ì„œ DTOë¡œ ì¡°íšŒí•˜ëŠ” ì½”ë“œë¥¼ ìž‘ì„±í•´ë³´ìž.
MemberDto
@Data @NoArgsConstructor public class MemberDto { private String username; private int age; public MemberDto(String username, int age) { this.username = username; this.age = age; } } 
ìˆœìˆ˜ JPAì—ì„œ DTO ì¡°íšŒ ì½”ë“œ
@Test public void findDtoByJPQL() { List&lt;MemberDto&gt; result = em.createQuery(&#34;select new study.querydsl.dto.MemberDto(m.username, m.age) from Member m&#34;, MemberDto.class) .getResultList(); for (MemberDto memberDto : result) { System.out.println(&#34;memberDto = &#34; + memberDto); } }  ìˆœìˆ˜ JPAì—ì„œ DTOë¥¼ ì¡°íšŒí•  ë•ŒëŠ” new ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ì•¼ í•¨ DTOì˜ packageì´ë¦„ì„ ë‹¤ ì ì–´ì¤˜ì•¼í•´ì„œ ì§€ì €ë¶„í•¨ ìƒì„±ìž ë°©ì‹ë§Œ ì§€ì›í•¨  QueryDSL ë¹ˆ ìƒì„± (Bean Population) ê²°ê³¼ë¥¼ DTOë°˜í™˜í•  ë–„ ì‚¬ìš©í•˜ë©° 3ê°€ì§€ ë°©ë²•ì´ ì¡´ìž¬í•œë‹¤.
 í”„ë¡œí¼í‹° ì ‘ê·¼ í•„ë“œ ì§ì ‘ ì ‘ê·¼ ìƒì„±ìž ì‚¬ìš©  í”„ë¡œí¼í‹° ì ‘ê·¼ - Setter
@Test public void findDtoBySetter() { List&lt;MemberDto&gt; result = queryFactory .select(Projections.bean(MemberDto.class, member.username, member.age)) .from(member) .fetch(); for (MemberDto memberDto : result) { System.out.println(&#34;memberDto = &#34; + memberDto); } }  Projections.bean(ì£¼ìž…ëŒ€ìƒí´ëž˜ìŠ¤, í”„ë¡œí¼í‹°1, í”„ë¡œí¼í‹°2&hellip;)ë°©ì‹ìœ¼ë¡œ í”„ë¡œí¼í‹°ì— ê°’ì„ ì£¼ìž…  í•„ë“œ ì§ì ‘ ì ‘ê·¼
@Test public void findDtoByField() { List&lt;MemberDto&gt; result = queryFactory .select(Projections.fields(MemberDto.class, member.username, member.age)) .from(member) .fetch(); for (MemberDto memberDto : result) { System.out.println(&#34;memberDto = &#34; + memberDto); } }  Getter, Setterê°€ ì—†ì–´ë„ í•„ë“œì— ë°”ë¡œ ê°’ì„ ì£¼ìž… Projections.fields(ì£¼ìž…ëŒ€ìƒí´ëž˜ìŠ¤, í•„ë“œ1, í•„ë“œ2&hellip;)  í•„ë“œ ì§ì ‘ ì ‘ê·¼ - ë³„ì¹­ì´ ë‹¤ë¥¼ ë•Œ
@Test public void findUserDtoByField() throws Exception { QMember memberSub = new QMember(&#34;memberSub&#34;); List&lt;UserDto&gt; result = queryFactory .select(Projections.fields(UserDto.class, member.username.as(&#34;name&#34;), ExpressionUtils.as(JPAExpressions .select(memberSub.age.max()) .from(memberSub), &#34;age&#34;) )) .from(member) .fetch(); for (UserDto memberDto : result) { System.out.println(&#34;memberDto = &#34; + memberDto); } }  í•„ë“œë‚˜ í”„ë¡œí¼í‹°ëª… ì ‘ê·¼ ìƒì„±ë°©ì‹ì—ì„œ ì´ë¦„ì´ ë‹¤ë¥¼ ë•Œ í•´ê²°ë°©ì•ˆì„ as(name)ì„ ì´ìš©í•´ì„œ í•´ê²°í•œë‹¤. ExpressionUtils.as(source,alias) : í•„ë“œë‚˜ ì„œë¸Œ ì¿¼ë¦¬ì— ë³„ì¹­ ì ìš© username.as(&quot;memberName&quot;) : í•„ë“œì— ë³„ì¹­ ì ìš©  ìƒì„±ìž ì ìš©
@Test public void findDtoByConstructor() { List&lt;MemberDto&gt; result = queryFactory .select(Projections.constructor(MemberDto.class, member.username, member.age)) .from(member) .fetch(); for (MemberDto memberDto : result) { System.out.println(&#34;memberDto = &#34; + memberDto); } } 
í”„ë¡œì ì…˜ê³¼ ê²°ê³¼ ë°˜í™˜ - @QueryProjection í”„ë¡œì ì…˜ê²°ê³¼ë¥¼ ë°˜í™˜í•  DTOì— @QueryProjection ì„ ìƒì„±ìžì— ë¶™í˜€ì¤€ ë’¤ gradle â†’ tasks â†’ other â†’ compileQuerydsl ì„ í†µí•´ DTOë„ Qíƒ€ìž…ìœ¼ë¡œ ìƒì„±í•´ ì¤€ë‹¤.
ìƒì„±ìž + @QueryProjection @Data @NoArgsConstructor public class MemberDto { private String username; private int age; @QueryProjection public MemberDto(String username, int age) { this.username = username; this.age = age; } }  ./gradlew compileQuerydsl QMemberDto ìƒì„± í™•ì¸  @QueryProjection í™œìš© @Test public void findDtoByQueryProjection() throws Exception{ List&lt;MemberDto&gt; result = queryFactory .]]></description>
</item><item>
    <title>QueryDSL ê¸°ë³¸ ë¬¸ë²•</title>
    <link>https://jaeyeonme.github.io/posts/querydsl-basic-grammer/</link>
    <pubDate>Fri, 31 Dec 2021 12:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/querydsl-basic-grammer/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/querydsl.png" referrerpolicy="no-referrer">
            </div>JPQL VS QueryDSL QueryDSL vs JPQL @Test public void startJQPL() { // member1ì„ ì°¾ì•„ë¼  String qlString = &#34;select m from Member m &#34; + &#34;where m.username = :username&#34;; Member findMember = em.createQuery(qlString, Member.class) .setParameter(&#34;username&#34;, &#34;member1&#34;) .getSingleResult(); assertThat(findMember.getUsername()).isEqualTo(&#34;member1&#34;); } @Test public void startQuerydsl() { // member1ì„ ì°¾ì•„ë¼.  JPAQueryFactory queryFactory = new JPAQueryFactory(em); QMember m = new QMember(&#34;m&#34;); Member findMember = queryFactory .select(m) .from(m) .where(m.username.eq(&#34;member1&#34;)) // íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì²˜ë¦¬  .fetchOne(); assertThat(findMember.getUsername()).isEqualTo(&#34;member1&#34;); }  EntityManager ë¡œ JPAQueryFactory ìƒì„± Querydslì€ JPQL ë¹Œë” JPQL : ë¬¸ìž(ì‹¤í–‰ ì‹œì  ì˜¤ë¥˜), Querydsl : ì½”ë“œ(ì»´íŒŒì¼ ì‹œì  ì˜¤ë¥˜) JPQL : íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì§ì ‘, Querydsl : íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ìžë™ ì²˜ë¦¬  JPAQueryFactoryë¥¼ í•„ë“œë¡œ @SpringBootTest @Transactional public class QuerydslBasicTest { @Autowired EntityManager em; JPAQueryFactory queryFactory; @BeforeEach public void before() { queryFactory = new JPAQueryFactory(em); // ... 	} @Test public void startQuerydsl() { // member1ì„ ì°¾ì•„ë¼.  QMember m = new QMember(&#34;m&#34;); Member findMember = queryFactory .select(m) .from(m) .where(m.username.eq(&#34;member1&#34;)) // íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì²˜ë¦¬  .fetchOne(); assertThat(findMember.getUsername()).isEqualTo(&#34;member1&#34;); } }  JPAQueryFactoryë¥¼ í•„ë“œë¡œ ì œê³µí•˜ë©´ ë™ì‹œì„± ë¬¸ì œëŠ” ì–´ë–»ê²Œ ë ê¹Œ? ë™ì‹œì„± ë¬¸ì œëŠ” JPAQueryFactoryë¥¼ ìƒì„±í•  ë•Œ ì œê³µí•˜ëŠ” EntityManager(em)ì— ë‹¬ë ¤ìžˆë‹¤. ìŠ¤í”„ë§ í”„ë ˆìž„ì›Œí¬ëŠ” ì—¬ëŸ¬ ì“°ë ˆë“œì—ì„œ ë™ì‹œì— ê°™ì€ EntityManagerì— ì ‘ê·¼í•´ë„, íŠ¸ëžœìž­ì…˜ ë§ˆë‹¤ ë³„ë„ì˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ê¸° ë•Œë¬¸ì—, ë™ì‹œì„± ë¬¸ì œëŠ” ê±±ì •í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.  ê¸°ë³¸ Q-Type í™œìš© Qí´ëž˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” 2ê°€ì§€ ë°©ë²• QMember qMember = new QMember(&#34;m&#34;); //ë³„ì¹­ ì§ì ‘ ì§€ì • QMember qMember = QMember.member; //ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš© 
ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ static importì™€ í•¨ê»˜ ì‚¬ìš© @Test public void startQuerydsl() { Member findMember = queryFactory .select(QMember.member) .from(QMember.member) .where(QMember.member.username.eq(&#34;member1&#34;)) // íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì²˜ë¦¬  .fetchOne(); assertThat(findMember.getUsername()).isEqualTo(&#34;member1&#34;); } 
ë‹¤ìŒ ì„¤ì •ì„ ì¶”ê°€í•˜ë©´ ì‹¤í–‰ë˜ëŠ” JPQLì„ ë³¼ ìˆ˜ ìžˆë‹¤.
spring.jpa.properties.hibernate.use_sql_comments: true 
ì°¸ê³ : ê°™ì€ í…Œì´ë¸”ì„ ì¡°ì¸í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ì•„ë‹ˆë©´ ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ìž
ê²€ìƒ‰ ì¡°ê±´ ì¿¼ë¦¬ ê¸°ë³¸ ê²€ìƒ‰ ì¿¼ë¦¬ @Test public void search() { Member findMember = queryFactory .selectFrom(member) .where(member.username.eq(&#34;member1&#34;) .and(member.age.eq(10))) .fetchOne(); assertThat(findMember.getUsername()).isEqualTo(&#34;member1&#34;); }  ê²€ìƒ‰ ì¡°ê±´ì€ .and() , .or() ë¥¼ ë©”ì„œë“œ ì²´ì¸ìœ¼ë¡œ ì—°ê²°í•  ìˆ˜ ìžˆë‹¤. select ì™€ from ì€ selectFrom ìœ¼ë¡œ í•©ì¹  ìˆ˜ ìžˆë‹¤.  JPQLì´ ì œê³µí•˜ëŠ” ëª¨ë“  ê²€ìƒ‰ ì¡°ê±´ ì œê³µ member.username.eq(&#34;member1&#34;) // username = &#39;member1&#39; member.username.ne(&#34;member1&#34;) //username != &#39;member1&#39; member.username.eq(&#34;member1&#34;).not() // username != &#39;member1&#39;  member.username.isNotNull() //ì´ë¦„ì´ is not null  member.age.in(10, 20) // age in (10,20) member.age.notIn(10, 20) // age not in (10, 20) member.age.between(10,30) // between 10, 30  member.age.goe(30) // age &gt;= 30 member.age.gt(30) // age &gt; 30 member.age.loe(30) // age &lt;= 30 member.age.lt(30) // age &lt; 30  member.username.like(&#34;member%&#34;) // like ê²€ìƒ‰ member.username.contains(&#34;member&#34;) // like â€˜%member%â€™ ê²€ìƒ‰ member.username.startsWith(&#34;member&#34;) // like â€˜member%â€™ ê²€ìƒ‰ 
AND ì¡°ê±´ì„ íŒŒë¼ë¯¸í„°ë¡œ ì²˜ë¦¬ @Test public void searchAndParam() { Member findMember = queryFactory .selectFrom(member) .where( member.username.eq(&#34;member1&#34;), member.age.eq(10)) .fetchOne(); assertThat(findMember.getUsername()).isEqualTo(&#34;member1&#34;); }  where() ì— íŒŒë¼ë¯¸í„°ë¡œ ì¡°ê±´ê²€ìƒ‰ì„ ì¶”ê°€í•˜ë©´ AND ì¡°ê±´ì´ ì¶”ê°€ë¨ ì´ ê²½ìš° null ê°’ì€ ë¬´ì‹œ â†’ ë©”ì„œë“œ ì¶”ì¶œì„ í™œìš©í•´ì„œ ë™ì  ì¿¼ë¦¬ë¥¼ ê¹”ë”í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìžˆìŒ â†’ ë’¤ì—ì„œ ì„¤ëª…  ê²°ê³¼ ì¡°íšŒ  fetch() : ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ, ë°ì´í„° ì—†ìœ¼ë©´ ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ fetchOne() : ë‹¨ ê±´ ì¡°íšŒ  ê²°ê³¼ê°€ ì—†ìœ¼ë©´ : null ê²°ê³¼ê°€ ë‘˜ ì´ìƒì´ë©´ : com.querydsl.core.NonUniqueResultException   fetchFirst() : limit(1).fetchOne() fetchResults() : íŽ˜ì´ì§• ì •ë³´ í¬í•¨, total count ì¿¼ë¦¬ ì¶”ê°€ ì‹¤í–‰ fetchCount() : count ì¿¼ë¦¬ë¡œ ë³€ê²½í•´ì„œ count ìˆ˜ ì¡°íšŒ  // List List&lt;Member&gt; fetch = queryFactory .selectFrom(member) .]]></description>
</item></channel>
</rss>
