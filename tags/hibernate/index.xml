<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>Hibernate - Tag - ğŸ“š | Dev Blog</title>
        <link>https://jaeyeonme.github.io/tags/hibernate/</link>
        <description>Hibernate - Tag - ğŸ“š | Dev Blog</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Fri, 31 Dec 2021 10:30:00 &#43;0000</lastBuildDate><atom:link href="https://jaeyeonme.github.io/tags/hibernate/" rel="self" type="application/rss+xml" /><item>
    <title>í™•ì¥ ê¸°ëŠ¥</title>
    <link>https://jaeyeonme.github.io/posts/spring-data-jpa-extension/</link>
    <pubDate>Fri, 31 Dec 2021 10:30:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/spring-data-jpa-extension/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/spring-data-jpa.png" referrerpolicy="no-referrer">
            </div>1. ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„ ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„  ìŠ¤í”„ë§ ë°ì´í„° JPA ë¦¬í¬ì§€í† ë¦¬ëŠ” ì¸í„°í˜ì´ìŠ¤ë§Œ ì •ì˜í•˜ê³  êµ¬í˜„ì²´ëŠ” ìŠ¤í”„ë§ì´ ìë™ ìƒì„± ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ë¥¼ ì§ì ‘ êµ¬í˜„í•˜ë©´ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ì´ ë„ˆë¬´ ë§ìŒ ë‹¤ì–‘í•œ ì´ìœ ë¡œ ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì„œë“œë¥¼ ì§ì ‘ êµ¬í˜„í•˜ê³  ì‹¶ë‹¤ë©´?  JPA ì§ì ‘ ì‚¬ìš©(EntityManager) ìŠ¤í”„ë§ JDBC Template ì‚¬ìš© MyBatis ì‚¬ìš© ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ ì§ì ‘ ì‚¬ìš© ë“±ë“±.. QueryDSL ì‚¬ìš©    ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤
public interface MemberRepositoryCustom { List&lt;Member&gt; findMemberCustom(); } 
ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ í´ë˜ìŠ¤
@RequiredArgsConstructor public class MemberRepositoryImpl implements MemberRepositoryCustom { private final EntityManager em; @Override public List&lt;Member&gt; findMemberCustom() { return em.createQuery(&#34;select m from Member m&#34;) .getResultList(); } } 
ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ ìƒì†
public interface MemberRepository extends JpaRepository&lt;Member, Long&gt;, MemberRepositoryCustom { } 
ì‚¬ìš©ì ì •ì˜ ë©”ì„œë“œ í˜¸ì¶œ ì½”ë“œ
List&lt;Member&gt; result = memberRepository.findMemberCustom(); 
ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ í´ë˜ìŠ¤
 ê·œì¹™ : ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„ + Impl ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì¸ì‹í•´ì„œ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡  Impl ëŒ€ì‹œ ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•˜ê³  ì‹¶ìœ¼ë©´?
XML ì„¤ì •
&lt;repositories base-package=&#34;study.datajpa.repository&#34; repository-impl-postfix=&#34;Impl&#34; /&gt; 
JavaConfig ì„¤ì •
@EnableJpaRepositories(basePackages = &#34;study.datajpa.repository&#34;, repositoryImplementationPostfix = &#34;Impl&#34;) 
ì°¸ê³  ì‹¤ë¬´ì—ì„œëŠ” ì£¼ë¡œ QueryDSLì´ë‚˜ SpringJdbcTemplateì„ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ ê¸°ëŠ¥ ìì£¼ ì‚¬ìš© í•­ìƒ ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ê°€ í•„ìš”í•œ ê²ƒì€ ì•„ë‹ˆë‹¤. ê·¸ëƒ¥ ì„ì˜ì˜ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ë§Œë“¤ì–´ë„ ëœë‹¤.
ì˜ˆë¥¼ë“¤ì–´ MemberQueryRepositoryë¥¼ ì¸í„°í˜ì´ìŠ¤ê°€ ì•„ë‹Œ í´ë˜ìŠ¤ë¡œ ë§Œë“¤ê³  ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì„œ ê·¸ëƒ¥ ì§ì ‘ ì‚¬ìš©í•´ë„ ëœë‹¤. ë¬¼ë¡  ì´ ê²½ìš° ìŠ¤í”„ë§ ë°ì´í„° JPAì™€ëŠ” ì•„ë¬´ëŸ° ê´€ê³„ ì—†ì´ ë³„ë„ë¡œ ë™ì‘í•œë‹¤.
ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„ ìµœì‹  ë°©ì‹ ìŠ¤í”„ë§ ë°ì´í„° 2.x ë¶€í„°ëŠ” ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ í´ë˜ìŠ¤ì— ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„ + Impl ì„ ì ìš©í•˜ëŠ” ëŒ€ì‹ ì— ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ ëª… + Impl ë°©ì‹ë„ ì§€ì›í•œë‹¤.
ì˜ˆë¥¼ ë“¤ì–´ ìœ„ ì˜ˆì œì˜ MemberRepositoryImpl ëŒ€ì‹ ì— MemberRepositoryCustomImpl ê°™ì´ êµ¬í˜„í•´ë„ ëœë‹¤.
ìµœì‹  ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ í´ë˜ìŠ¤ ì˜ˆì œ
@RequiredArgsConstructor public class MemberRepositoryCustomImpl implements MemberRepositoryCustom { private final EntityManager em; @Override public List&lt;Member&gt; findMemberCustom() { return em.createQuery(&#34;select m from Member m&#34;) .getResultList(); } } ê¸°ì¡´ ë°©ì‹ë³´ë‹¤ ì´ ë°©ì‹ì´ ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„ê³¼ êµ¬í˜„ í´ë˜ìŠ¤ ì´ë¦„ì´ ë¹„ìŠ·í•˜ë¯€ë¡œ ë” ì§ê´€ì ì´ë‹¤. ì¶”ê°€ë¡œ ì—¬ëŸ¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë¶„ë¦¬í•´ì„œ êµ¬í˜„í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ìƒˆë¡­ê²Œ ë³€ê²½ëœ ì´ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë” ê¶Œì¥í•œë‹¤.
2. Auditing  ì—”í‹°í‹°ë¥¼ ìƒì„±, ë³€ê²½í•  ë•Œ ë³€ê²½í•œ ì‚¬ëŒê³¼ ì‹œê°„ì„ ì¶”ì í•˜ê³  ì‹¶ìœ¼ë©´?  ë“±ë¡ì¼ ìˆ˜ì •ì¼ ë“±ë¡ì ìˆ˜ì •ì    ìˆœìˆ˜ JPA ì‚¬ìš© ìš°ì„  ë“±ë¡ì¼, ìˆ˜ì •ì¼ ì ìš©
@Getter @MappedSuperclass public class JpaBaseEntity { @Column(updatable = false) private LocalDateTime createdDate; private LocalDateTime updatedDate; @PrePersist public void prePersist() { LocalDateTime now = LocalDateTime.now(); createdDate = now; updatedDate = now; } @PreUpdate public void preUpdate() { updatedDate = LocalDateTime.now(); } } JPA ì£¼ìš” ì´ë²¤íŠ¸ ì–´ë…¸í…Œì´ì…˜
 @PrePersist, @PostPersist @PreUpdate, @PostUpdate  ìŠ¤í”„ë§ ë°ì´í„° JPA ì‚¬ìš© ì„¤ì •
@EnableJpaAuditing â†’ ìŠ¤í”„ë§ ë¶€íŠ¸ ì„¤ì • í´ë˜ìŠ¤ì— ì ìš©í•´ì•¼í•¨
@EntityListeners(AuditingEntityListener.class) â†’ ì—”í‹°í‹°ì— ì ìš©
ì‚¬ìš© ì–´ë…¸í…Œì´ì…˜
 @CreatedDate @LastModifiedDate @CreatedBy @LastModifiedBy  ìŠ¤í”„ë§ ë°ì´í„° Auditing ì ìš© - ë“±ë¡ì¼, ìˆ˜ì •ì¼
@EntityListeners(AuditingEntityListener.class) @MappedSuperclass @Getter public class BaseEntity { @CreatedBy @Column(updatable = false) private String createdBy; @LastModifiedBy private String lastModifiedBy; } 
ìŠ¤í”„ë§ ë°ì´í„° Auditing ì ìš© - ë“±ë¡ì, ìˆ˜ì •ì
@EntityListeners(AuditingEntityListener.class) @MappedSuperclass @Getter public class BaseTimeEntity { @CreatedDate @Column(updatable = false) private LocalDateTime createdDate; @LastModifiedDate private LocalDateTime lastModifiedDate; } 
ë“±ë¡ì, ìˆ˜ì •ìë¥¼ ì²˜ë¦¬í•´ì£¼ëŠ” AuditorAware ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡
@Bean public AuditorAware&lt;String&gt; auditorProvider() { return () -&gt; Optional.of(UUID.randomUUID().toString()); } ì‹¤ë¬´ì—ì„œëŠ” ì„¸ì…˜ ì •ë³´ë‚˜, ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ë¡œê·¸ì¸ ì •ë³´ì—ì„œ IDë¥¼ ë°›ìŒ]]></description>
</item><item>
    <title>ì¿¼ë¦¬ ë©”ì†Œë“œ</title>
    <link>https://jaeyeonme.github.io/posts/spring-data-jpa-query-method/</link>
    <pubDate>Fri, 31 Dec 2021 09:30:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/spring-data-jpa-query-method/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/spring-data-jpa.png" referrerpolicy="no-referrer">
            </div>1. ì¿¼ë¦¬ ë©”ì†Œë“œ ê¸°ëŠ¥  ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„± NamedQuery @Query - ë¦¬íŒŒì§€í† ë¦¬ ë©”ì†Œë“œì— ì¿¼ë¦¬ ì •ì˜ íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ë°˜í™˜ íƒ€ì… í˜ì´ì§•ê³¼ ì •ë ¬ ë²Œí¬ì„± ìˆ˜ì • ì¿¼ë¦¬ @EntityGraph  ì¿¼ë¦¬ ë©”ì†Œë“œ ê¸°ëŠ¥ 3ê°€ì§€
 ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„± ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ JPA namedQuery í˜¸ì¶œ @Query ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ì— ì¿¼ë¦¬ ì§ì ‘ ì •ì˜  ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„± ë©”ì†Œë“œ ì´ë¦„ì„ ë¶„ì„í•´ì„œ JPQL ì¿¼ë¦¬ ì‹¤í–‰
ì´ë¦„ê³¼ ë‚˜ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ íšŒì›ì„ ì¡°íšŒí•˜ë ¤ë©´?
ìˆœìˆ˜ JPA ë¦¬í¬ì§€í† ë¦¬
public List&lt;Member&gt; findByUsernameAndAgeGreaterThen(String username, int age) { return em.createQuery(&#34;select m from Member m where m.username = :username and m.age &gt; :age&#34;) .setParameter(&#34;username&#34;, username) .setParameter(&#34;age&#34;, age) .getResultList(); } 
ìˆœìˆ˜ JPA í…ŒìŠ¤íŠ¸ ì½”ë“œ
@Test public void findByUsernameAndAgeGreaterThen() { Member m1 = new Member(&#34;AAA&#34;, 10); Member m2 = new Member(&#34;AAA&#34;, 20); memberJpaRepository.save(m1); memberJpaRepository.save(m2); List&lt;Member&gt; result = memberJpaRepository.findByUsernameAndAgeGreaterThen(&#34;AAA&#34;, 15); assertThat(result.get(0).getUsername()).isEqualTo(&#34;AAA&#34;); assertThat(result.get(0).getAge()).isEqualTo(20); assertThat(result.size()).isEqualTo(1); } 
ìŠ¤í”„ë§ ë°ì´í„° JPA
public interface MemberRepository extends JpaRepository&lt;Member, Long&gt; { List&lt;Member&gt; findByUsernameAndAgeGreaterThan(String username, int age); }  ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ë©”ì†Œë“œ ì´ë¦„ì„ ë¶„ì„í•´ì„œ JPQLì„ ìƒì„±í•˜ê³  ì‹¤í–‰  ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì œê³µí•˜ëŠ” ì¿¼ë¦¬ ë©”ì†Œë“œ ê¸°ëŠ¥
 ì¡°íšŒ: findâ€¦By ,readâ€¦By ,queryâ€¦By getâ€¦By,  https://docs.spring.io/spring-data/jpa/docs/current/reference/html/ #repositories.query-methods.query-creation ì˜ˆ:) findHelloBy ì²˜ëŸ¼ &hellip;ì— ì‹ë³„í•˜ê¸° ìœ„í•œ ë‚´ìš©(ì„¤ëª…)ì´ ë“¤ì–´ê°€ë„ ëœë‹¤.   COUNT: countâ€¦By ë°˜í™˜íƒ€ì… long EXISTS: existsâ€¦By ë°˜í™˜íƒ€ì… boolean ì‚­ì œ: deleteâ€¦By, removeâ€¦By ë°˜í™˜íƒ€ì… long DISTINCT: findDistinct, findMemberDistinctBy LIMIT: findFirst3, findFirst, findTop, findTop3  https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.limit-query-result    ì°¸ê³  ì´ ê¸°ëŠ¥ì€ ì—”í‹°í‹°ì˜ í•„ë“œëª…ì´ ë³€ê²½ë˜ë©´ ì¸í„°í˜ì´ìŠ¤ì— ì •ì˜í•œ ë©”ì„œë“œ ì´ë¦„ë„ ê¼­ í•¨ê»˜ ë³€ê²½í•´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•˜ëŠ” ì‹œì ì— ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ì´ë ‡ê²Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œë”© ì‹œì ì— ì˜¤ë¥˜ë¥¼ ì¸ì§€í•  ìˆ˜ ìˆëŠ” ê²ƒì´ ìŠ¤í”„ë§ ë°ì´í„° JPAì˜ ë§¤ìš° í° ì¥ì ì´ë‹¤.
2. JPA NamedQuery JPAì˜ NamedQueryë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŒ
@NamedQuery ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ Named ì¿¼ë¦¬ ì •ì˜
@Entity @NamedQuery( name = &#34;Member.findByUsername&#34;, query = &#34;select m from Member m where m.username = :username&#34; ) public class Member { ... } 
JPAë¥¼ ì§ì ‘ ì‚¬ìš©í•´ì„œ Named ì¿¼ë¦¬ í˜¸ì¶œ
public class MemberRepository { public List&lt;Member&gt; findByUsername(String username) { ... return em.createNamedQuery(&#34;Member.findByUsername&#34;, Member.class) .setParameter(&#34;username&#34;, username) .getResultList(); } } 
ìŠ¤í”„ë§ ë°ì´í„° JPAë¡œ NamedQuery ì‚¬ìš©
@Query(name = &#34;Member.findByUsername&#34;) List&lt;Member&gt; findByUsername(@Param(&#34;username&#34;) String username); @Query ë¥¼ ìƒëµí•˜ê³  ë©”ì„œë“œ ì´ë¦„ë§Œìœ¼ë¡œ Named ì¿¼ë¦¬ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
ìŠ¤í”„ë§ ë°ì´í„° JPAë¡œ Named ì¿¼ë¦¬ í˜¸ì¶œ
public interface MemberRepository extends JpaRepository&lt;Member, Long&gt; { // ** ì—¬ê¸° ì„ ì–¸í•œ Member ë„ë©”ì¸ í´ë˜ìŠ¤  List&lt;Member&gt; findByUsername(@Param(&#34;username&#34;) String username); }  ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ì„ ì–¸í•œ &ldquo;ë„ë©”ì¸ í´ë˜ìŠ¤ + .(ì ) + ë©”ì„œë“œ ì´ë¦„&rdquo; ìœ¼ë¡œ Named ì¿¼ë¦¬ë¥¼ ì°¾ì•„ì„œ ì‹¤í–‰ ë§Œì•½ ì‹¤í–‰í•  Named ì¿¼ë¦¬ê°€ ì—†ìœ¼ë©´ ë©”ì„œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„± ì „ëµì„ ì‚¬ìš©í•œë‹¤. í•„ìš”í•˜ë©´ ì „ëµì„ ë³€ê²½í•  ìˆ˜ ìˆì§€ë§Œ ê¶Œì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.  ì°¸ê³  : https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.query-methods.query-lookup-strategies    ì°¸ê³  ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•˜ë©´ ì‹¤ë¬´ì—ì„œ Named Queryë¥¼ ì§ì ‘ ë“±ë¡í•´ì„œ ì‚¬ìš©í•˜ëŠ” ì¼ì€ ë“œë¬¼ë‹¤. ëŒ€ì‹  @Query ë¥¼ ì‚¬ìš©í•´ì„œ ë¦¬í¬ì§€í† ë¦¬ ë©”ì†Œë“œì— ì¿¼ë¦¬ë¥¼ ì§ì ‘ ì •ì˜í•œë‹¤.
3. @Query, ë¦¬í¬ì§€í† ë¦¬ ë©”ì†Œë“œì— ì¿¼ë¦¬ ì •ì˜í•˜ê¸° ë©”ì„œë“œ JPQL ì¿¼ë¦¬ ì‘ì„± public interface MemberRepository extends JpaRepository&lt;Member, Long&gt; { @Query(&#34;select m from Member m where m.username = :username and m.age = :age&#34;) List&lt;Member&gt; findUser(@Param(&#34;username&#34;) String username, @Param(&#34;age&#34;) int age); }  @org.springframework.data.jpa.repository.Query ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš© ì‹¤í–‰í•  ë©”ì„œë“œì— ì •ì  ì¿¼ë¦¬ë¥¼ ì§ì ‘ ì‘ì„±í•˜ë¯€ë¡œ ì´ë¦„ ì—†ëŠ” Named ì¿¼ë¦¬ë¼ í•  ìˆ˜ ìˆìŒ JPA Named ì¿¼ë¦¬ì²˜ëŸ¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œì ì— ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ë°œê²¬í•  ìˆ˜ ìˆìŒ (ë§¤ìš° í° ì¥ì !)  ì°¸ê³  ì‹¤ë¬´ì—ì„œëŠ” ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„± ê¸°ëŠ¥ì€ íŒŒë¼ë¯¸í„°ê°€ ì¦ê°€í•˜ë©´ ë©”ì„œë“œ ì´ë¦„ì´ ë§¤ìš° ì§€ì €ë¶„í•´ì§„ë‹¤.]]></description>
</item><item>
    <title>ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ê¸°ëŠ¥</title>
    <link>https://jaeyeonme.github.io/posts/spring-data-jpa-common-interface/</link>
    <pubDate>Fri, 31 Dec 2021 09:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/spring-data-jpa-common-interface/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/spring-data-jpa.png" referrerpolicy="no-referrer">
            </div>1. ìˆœìˆ˜ JPAê¸°ë°˜ ë¦¬í¬ì§€í† ë¦¬ ë§Œë“¤ê¸°  ê¸°ë³¸ CRUD  ì €ì¥ ë³€ê²½ â†’ ë³€ê²½ê°ì§€ ì‚¬ìš© ì‚­ì œ ì „ì²´ ì¡°íšŒ ë‹¨ê±´ ì¡°íšŒ ì¹´ìš´íŠ¸     ì°¸ê³ : JPAì—ì„œ ìˆ˜ì •ì€ ë³€ê²½ê°ì§€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤. íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•œ ë‹¤ìŒì— ë°ì´í„°ë¥¼ ë³€ê²½í•˜ë©´, íŠ¸ëœì­ì…˜ ì¢…ë£Œ ì‹œì ì— ë³€ê²½ê°ì§€ ê¸°ëŠ¥ì´ ì‘ë™í•´ì„œ ë³€ê²½ëœ ì—”í‹°í‹°ë¥¼ ê°ì§€í•˜ê³  UPDATE SQLì„ ì‹¤í–‰í•œë‹¤.
 ìˆœìˆ˜ JPA ê¸°ë°˜ ë¦¬í¬ì§€í† ë¦¬
@Repository public class MemberJpaRepository { @PersistenceContext private EntityManager em; // Create (ì €ì¥)  public Member save(Member member) { em.persist(member); return member; } // Delete (ì‚­ì œ)  public void delete(Member member) { em.remove(member); } // Read (ì¡°íšŒ)  public List&lt;Member&gt; findAll() { // JPQL  return em.createQuery(&#34;select m from Member m&#34;, Member.class) .getResultList(); } public Optional&lt;Member&gt; findById(Long id) { Member member = em.find(Member.class, id); return Optional.ofNullable(member); } public long count() { return em.createQuery(&#34;select count(m) from Member m&#34;, Long.class) .getSingleResult(); } public Member find(Long id) { return em.find(Member.class, id); } }  íšŒì› ë¦¬í¬ì§€í† ë¦¬ì™€ ê±°ì˜ ë™ì¼í•˜ë‹¤.  2. ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ì„¤ì • javaConfig ì„¤ì • - ìŠ¤í”„ë§ ë¶€íŠ¸ ì‚¬ìš©ì‹œ ìƒëµ ê°€ëŠ¥ @Configuration @EnableJpaRepositories(basePackages = &#34;jpabook.jpashop.repository&#34;) public class AppConfig {}  ìŠ¤í”„ë§ ë¶€íŠ¸ ì‚¬ìš©ì‹œ @SpringBootApplication ìœ„ì¹˜ë¥¼ ì§€ì •(í•´ë‹¹ íŒ¨í‚¤ì§€ì™€ í•˜ìœ„ íŒ¨í‚¤ì§€ ì¸ì‹) ë§Œì•½ ìœ„ì¹˜ê°€ ë‹¬ë¼ì§€ë©´ @EnableJpaRepositories í•„ìš”  ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ êµ¬í˜„ í´ë˜ìŠ¤ ëŒ€ì‹  ìƒì„±  org.springframework.data.repository.Repository ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ëŠ” ìŠ¤ìº” ëŒ€ìƒ  MemberRepository ì¸í„°í˜ì´ìŠ¤ê°€ ë™ì‘í•œ ì´ìœ  ì‹¤ì œ ì¶œë ¥í•´ë³´ê¸°(Proxy) memberRepository.getClass() â†’ class com.sun.proxy.$ProxyXXX   @Repository ì• ë…¸í…Œì´ì…˜ ìƒëµ ê°€ëŠ¥  ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬ JPA ì˜ˆì™¸ë¥¼ ìŠ¤í”„ë§ ì˜ˆì™¸ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ë„ ìë™ìœ¼ë¡œ ì²˜ë¦¬    3. ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ì ìš© ìˆœìˆ˜ JPAë¡œ êµ¬í˜„í•œ MemberJpaRepository ëŒ€ì‹ ì— ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì œê³µí•˜ëŠ” ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš©
ìŠ¤í”„ë§ ë°ì´í„° JPA ê¸°ë°˜ Repository public interface MemberRepository extends JpaRepository&lt;Member, Long&gt; { }  Generic  T : ì—”í‹°í‹° íƒ€ì… ID : ì‹ë³„ì íƒ€ì…(PK)    4. ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ë¶„ì„  JpaRepository ì¸í„°í˜ì´ìŠ¤ : ê³µí†µ CURD ì œê³µ ì œë„¤ë¦­ì€ &lt;ì—”í‹°í‹° íƒ€ì…, ì‹ë³„ì íƒ€ì…&gt; ì„¤ì •  JpaRepository ê³µí†µ ê¸°ëŠ¥ ì¸í„°í˜ì´ìŠ¤
public interface JpaRepository&lt;T, ID extends Serializable&gt; extends PagingAndSortingRepository&lt;T, ID&gt; { ... } 
JpaRepository ë¥¼ ì‚¬ìš©í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤
public interface MemberRepository extends JpaRepository&lt;Member, Long&gt; { } 
ê³µí†µ ì¸í„°í˜ì´ìŠ¤ êµ¬ì„± ì£¼ì˜
 T findOne(ID) â†’ Optional&lt;T&gt; findById(ID) ë³€ê²½  ì œë„¤ë¦­ íƒ€ì…
 T : ì—”í‹°í‹° ID : ì—”í‹°í‹°ì˜ ì‹ë³„ì íƒ€ì… S : ì—”í‹°í‹°ì™€ ê·¸ ìì‹ íƒ€ì…  ì£¼ìš” ë©”ì„œë“œ
 save(S) : ìƒˆë¡œìš´ ì—”í‹°í‹°ëŠ” ì €ì¥í•˜ê³  ì´ë¯¸ ìˆëŠ” ì—”í‹°í‹°ëŠ” ë³‘í•©í•œë‹¤. delete(T) : ì—”í‹°í‹° í•˜ë‚˜ë¥´ ì‚­ì œí•œë‹¤. ë‚´ë¶€ì—ì„œ EntityManager.remove() í˜¸ì¶œ findById(ID) : ì—”í‹°í‹° í•˜ë‚˜ë¥¼ ì¡°íšŒí•œë‹¤. ë‚´ë¶€ì—ì„œ EntityManager.find() í˜¸ì¶œ getOne(ID) : ì—”í‹°í‹°ë¥¼ í”„ë¡ì‹œë¡œ ì¡°íšŒí•œë‹¤. ë‚´ë¶€ì—ì„œ EntityManager.getReference() í˜¸ì¶œ findAll(...) : ëª¨ë“  ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•œë‹¤. ì •ë ¬(Sort)ì´ë‚˜ í˜ì´ì§•(Pageable) ì¡°ê±´ì„ íŒŒë¼ë¯¸í„°ë¡œ ì œê³µí•  ìˆ˜ ìˆë‹¤.  ì°¸ê³ : JpaRepository ëŠ” ëŒ€ë¶€ë¶„ì˜ ê³µí†µ ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤.]]></description>
</item><item>
    <title>ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ - ì¤‘ê¸‰ ë¬¸ë²•</title>
    <link>https://jaeyeonme.github.io/posts/jpa-object-query-language2/</link>
    <pubDate>Thu, 30 Dec 2021 10:20:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-object-query-language2/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ê²½ë¡œ í‘œí˜„ì‹  .(ì )ì„ ì°ì–´ ê°ì²´ ê·¸ë˜í”„ë¥¼ íƒìƒ‰í•˜ëŠ” ê²ƒ select m.username -&gt; ìƒíƒœ í•„ë“œ from Member m join m.team t -&gt; ë‹¨ì¼ ê°’ ì—°ê´€ í•„ë“œ join m.orders o -&gt; ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ í•„ë“œ where t.name = &#39;íŒ€A&#39; 
ê²½ë¡œ í‘œí˜„ì‹ ìš©ì–´ ì •ë¦¬
 ìƒíƒœ í•„ë“œ(state field): ë‹¨ìˆœíˆ ê°’ì„ ì €ì¥í•˜ê¸° ìœ„í•œ í•„ë“œ(ex: m.usernmae) ì—°ê´€ í•„ë“œ(association field): ì—°ê´€ê´€ê³„ë¥¼ ìœ„í•œ í•„ë“œ  ë‹¨ì¼ ê°’ ì—°ê´€ í•„ë“œ:  @ManyToOne, @OneToOne: ëŒ€ìƒì´ ì—”í‹°í‹°(ex: m.team)  ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ í•„ë“œ:  @OneToMany, @ManyToMany, ëŒ€ìƒì´ ì»¬ë ‰ì…˜(ex m.orders)   ê²½ë¡œ í‘œí˜„ì‹ íŠ¹ì§•
  ìƒíƒœ í•„ë“œ(state field): ê²½ë¡œ íƒìƒ‰ì˜ ë, íƒìƒ‰x
  ë‹¨ì¼ ê°’ ì—°ê´€ ê²½ë¡œ: ë¬µì‹œì  ë‚´ë¶€ ì¡°ì¸(inner join)ë°œìƒ, íƒìƒ‰O
select m.team.name from Member m; //teamì—ì„œ ê²½ë¡œíƒìƒ‰ì´ ë” ê°€ëŠ¥í•˜ë‹¤(name)   ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ ê²½ë¡œ: ë¬µì‹œì  ë‚´ë¶€ ì¡°ì¸ ë°œìƒ, íƒìƒ‰X
  FROM ì ˆì—ì„œ ëª…ì‹œì  ì¡°ì¸ì„ í†µí•´ ë³„ì¹­ì„ ì–»ìœ¼ë©´ ë³„ì¹­ì„ í†µí•´ íƒìƒ‰ ê°€ëŠ¥
select m.username from Team t join t.members m;     ì‹¤ë¬´ì—ì„œëŠ” ëª…ì‹œì  ì¡°ì¸ì„ ì‚¬ìš©í•˜ì.
ì¡°ì¸ì€ SQL íŠœë‹ì— ì¤‘ìš” í¬ì¸íŠ¸
ë¬µì‹œì  ì¡°ì¸ì€ ì¡°ì¸ì´ ì¼ì–´ë‚˜ëŠ” ìƒí™©ì„ í•œëˆˆì— íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€
2. JPQL - í˜ì¹˜ ì¡°ì¸ (fetchjoin)   SQL ì¡°ì¸ ì¢…ë¥˜ëŠ” ì•„ë‹ˆê³  JPAì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. JPQLì—ì„œ ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥. ì—°ê´€ëœ ì—”í‹°í‹°ë‚˜ ì»¬ë ‰ì…˜ì„ SQL í•œ ë²ˆì— í•¨ê»˜ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ join fetch ëª…ë ¹ì–´ ì‚¬ìš© í˜ì¹˜ ì¡°ì¸ :: = [LEFT [OUTER] | INNER ] JOIN FETCH ì¡°ì¸ ê²½ë¡œ  ì—”í‹°í‹° í˜ì¹˜ ì¡°ì¸
  íšŒì›ì„ ì¡°íšŒí•˜ë©´ì„œ ì—°ê´€ëœ íŒ€ë„ í•¨ê»˜ ì¡°íšŒ(SQL í•œ ë²ˆì—)
//JPQL select m from Member m join fetch m.team //SQL select m.* t.* from Member m inner join Team t on m.team_id = t.id;     ë„ì‹í™”
íŒ€ì´ ìˆëŠ” íšŒì›ì„ ì¡°íšŒí•˜ê³  ì‹¶ì„ ë•Œ fetch joinì„ ì‚¬ìš©í•˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ inner joinì„ ì‚¬ìš©í•œë‹¤.
íŒ€ì´ ì—†ëŠ” íšŒì›ì€ ëˆ„ë½ëœë‹¤.
  í˜ì¹˜ ì¡°ì¸ ì‚¬ìš© ì½”ë“œ
  ê¸°ì¡´ ì—°ê´€ê´€ê³„ ì¡°íšŒ ë¡œì§ì˜ ë¬¸ì œ
String jpql = &#34;select m from Member m&#34;; List&lt;Member&gt; members = em.createQuery(jpql, Member.class) .getResultList(); for (Member member : members) { System.out.println(&#34;username = &#34; + member.getUsername() + &#34;, &#34; + &#34;teamName = &#34; + member.getTeam().name()); //íšŒì›1, íŒ€A(SQL) //íšŒì›2, íŒ€A(1ì°¨ ìºì‹œ) //íšŒì›3, íŒ€B(SQL)  //íšŒì› 100ëª… -&gt; N + 1 } ìµœì´ˆ jpqlì„ í†µí•´ Memberë¥¼ ì¡°íšŒí•´ ì˜¬ë•Œ Teamì˜ ì •ë³´ëŠ” Proxyê°ì²´ë¡œ ê°€ì§€ê³  ìˆë‹¤. (ì‹¤ì œë¡  ì—†ë‹¤ëŠ” ì˜ë¯¸) ê·¸ë ‡ê¸°ì— ì‹¤ì œë¡œ getTeam().getName()ì„ í†µí•´ íŒ€ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•˜ë ¤ê³  í•  ë•Œ SQLì„ ìˆ˜í–‰í•œë‹¤. ì£¼ì„ ë‚´ìš©ëŒ€ë¡œ í•œë²ˆ ê°€ì ¸ì˜¨ Teamì˜ ì •ë³´ëŠ” 1ì°¨ ìºì‹œì— ì˜¬ë¼ê°€ ìˆê¸° ë•Œë¬¸ì— ë” ì¡°íšŒí•  í•„ìš”ëŠ” ì—†ì§€ë§Œ, íšŒì›ì„ Nëª… ì¡°íšŒí•˜ê²Œ ë˜ì—ˆì„ë•Œ ìµœëŒ€ N + 1 ë²ˆ Team ì¡°íšŒ ì¿¼ë¦¬ê°€ ìˆ˜í–‰ ë  ìˆ˜ ìˆë‹¤.
    í˜ì¹˜ ì¡°ì¸ì„ í†µí•œ í•´ê²°
String jpql = &#34;select m from Member m join fetch m.team&#34;; List&lt;Member&gt; members = em.createQuery(jpql, Member.class) .getResultList(); for (Member member : members) { //í˜ì¹˜ ì¡°ì¸ìœ¼ë¡œ íšŒì›ê³¼ íŒ€ì„ í•¨ê»˜ ì¡°íšŒí•´ì„œ ì§€ì—° ë¡œë”©X  System.out.println(&#34;username = &#34; + member.getUsername() + &#34;, &#34; + &#34;teamName = &#34; + member.getTeam().name()); } í˜ì¹˜ì¡°ì¸ì€ ì¡°íšŒ ë‹¹ì‹œì— ì‹¤ì œ ì—”í‹°í‹°ê°€ ë‹´ê¸´ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì§€ì—°ë¡œë”© ì—†ì´ ë°”ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.
  ì‹¤ë¬´ì—ì„œ ìì£¼ ì‚¬ìš©ëœë‹¤. ì»¬ë ‰ì…˜ í˜ì¹˜ ì¡°ì¸
 ì¼ëŒ€ë‹¤ ê´€ê³„, ì»¬ë ‰ì…˜ í˜ì¹˜ ì¡°ì¸  //JPQL select t from Team t join fetch t.members where t.name = &#39;íŒ€A&#39;; //SQL select t.*, m.* from team t, inner join member m on t.]]></description>
</item><item>
    <title>ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ - ê¸°ë³¸ ë¬¸ë²•</title>
    <link>https://jaeyeonme.github.io/posts/jpa-object-query-language1/</link>
    <pubDate>Thu, 30 Dec 2021 10:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-object-query-language1/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ì†Œê°œ  JPAëŠ” ë‹¤ì–‘í•œ ì¿¼ë¦¬ ë°©ë²•ì„ ì§€ì›
 JPQL JPA Criteria QueryDSL Native SQL JDBC API ì§ì ‘ ì‚¬ìš©, MyBatis, SpringJdbcTemplate í•¨ê»˜ ì‚¬ìš©  JPQL ì†Œê°œ
 ê°€ì¥ ë‹¨ìˆœí•œ ì¡°íšŒ ë°©ë²•  EntityManager.find() ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ (a.getB().getC())   ë‚˜ì´ê°€ 18ì‚´ ì´ìƒì¸ íšŒì›ì„ ëª¨ë‘ ê²€ìƒ‰í•˜ê³  ì‹¶ë‹¤ë©´?  JPQL - í•„ìš”ì„±
 JPAë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹° ê°ì²´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ê°œë°œ ë¬¸ì œëŠ” ê²€ìƒ‰ ì¿¼ë¦¬ ê²€ìƒ‰ì„ í•  ë•Œë„ í…Œì´ë¸”ì´ ì•„ë‹Œ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ìƒ‰ ëª¨ë“  DB ë°ì´í„°ë¥¼ ê°ì²´ë¡œ ë³€í™˜í•´ì„œ ê²€ìƒ‰í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í•„ìš”í•œ ë°ì´í„°ë§Œ DBì—ì„œ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ ê²°êµ­ ê²€ ìƒ‰ ì¡°ê±´ì´ í¬í•¨ëœ SQLì´ í•„ìš”  JPQL - íŠ¹ì§•
  JPAëŠ” SQLì„ ì¶”ìƒí™”í•œ JPQLì´ë¼ëŠ” ê°ì²´ ì§€í–¥ ì¿¼ë¦¬ë¥¼ ì œê³µ
String sql = &#34;select m from Member.class as m where m.username like &#39;%until%&#39;&#34;; ì¼ë°˜ SQLê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ì—”í‹°í‹°ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•œë‹¤ëŠ” ì ì´ ë‹¤ë¥´ë‹¤.
 SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ SQLì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤. ë™ì  ì¿¼ë¦¬ ìƒì„±ì´ ì‰½ì§€ ì•Šë‹¤.    Criteria - ì†Œê°œ
 ë¬¸ìê°€ ì•„ë‹Œ ìë°”ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ  //Criteria ì‚¬ìš© ì¤€ë¹„ CriteriaBuilder cb = em.getCriteriaBuilder(); CriteriaQuery&lt;Member&gt; query = cb.createQuery(Member.class); //ë£¨íŠ¸ í´ë˜ìŠ¤ (ì¡°íšŒë¥¼ ì‹œì‘í•  í´ë˜ìŠ¤) Root&lt;Member&gt; m = query.from(Member.class); //ì¿¼ë¦¬ ìƒì„± CriteriaQuery&lt;Member&gt; cq = query.select(m).where(cb.equal(m.get(&#34;username&#34;), â€œkimâ€)); List&lt;Member&gt; resultList = em.createQuery(cq).getResultList()  JPQL ë¹Œë” ì—­í•  JPA ê³µì‹ ê¸°ëŠ¥  âŒì‹¤ë¬´ì—ì„  ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.
 ì¿¼ë¦¬ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ëŠ” ìˆì§€ë§Œ êµ¬í˜„ì´ ë„ˆë¬´ ë³µì¡í•˜ê³  ì‹¤ìš©ì„±ì´ ì—†ë‹¤. ë¬¸ìê°€ ì•„ë‹Œ ìë°”ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ JPQL ë¹Œë” ì—­í•  JPA ê³µì‹ ê¸°ëŠ¥ ë‹¨ì  : ë„ˆë¬´ ë³µì¡í•˜ê³  ì‹¤ìš©ì„±ì´ ì—†ë‹¤. Criteria ëŒ€ì‹ ì— QueryDSL ì‚¬ìš© ê¶Œì¥  QueryDSL ì†Œê°œ
ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬
// JPQL // SELECT m from Member m WHERE m.age &gt; 18 JPAFactoryQuery query = new JPAQueryFactory(em); QMember m = QMember.member; List&lt;Member&gt; list = query.selectFrom(m) .where(m.age.gt(18)) .orderBy(m.name.desc()) .fetch();   ë¬¸ìê°€ ì•„ë‹Œ ìë°”ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ
  JPQL ë¹Œë” ì—­í• 
  ì»´íŒŒì¼ ì‹œì ì— ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŒ
  ... List&lt;Member&gt; list = query.selectFrom(m) .wheree(m.age.gt(18)) //ì»´íŒŒì¼ ì‹œì ì—ì„œ ì˜¤ë¥˜ ê²€ì¶œ ê°€ëŠ¥  .orderBy(m.name.desc()) .fetch()  ë™ì ì¿¼ë¦¬ ì‘ì„± í¸ë¦¬í•¨ ë‹¨ìˆœí•˜ê³  ì‰½ë‹¤. ì‹¤ë¬´ ì‚¬ìš© ê¶Œì¥  ë„¤ì´í‹°ë¸Œ SQL ì†Œê°œ
  JPAê°€ ì œê³µí•˜ëŠ” SQLì„ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥
  JPQLë¡œ í•´ê²°í•  ìˆ˜ ì—†ëŠ” íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì˜ì¡´ì ì¸ ê¸°ëŠ¥
 ex: ì˜¤ë¼í´ CONNECT BY, íŠ¹ì • DBë§Œ ì‚¬ìš©í•œëŠ” SQL íŒíŠ¸  String sql =&#34;SELECT ID, AGE, TEAM_ID, NAME FROM MEMBER WHERE NAME = â€˜kimâ€™&#34;; List&lt;Member&gt; resultList = em.createNativeQuery(sql, Member.class) .getResultList();   JDBC ì§ì ‘ ì‚¬ìš©, SpringJdbcTemplate ë“±
  PAë¥¼ ì‚¬ìš©í•˜ë©´ì„œ JDBC ì»¤ë„¥ì…˜ì„ ì§ì ‘ ì‚¬ìš©í•˜ê±°ë‚˜, ìŠ¤í”„ë§ JdbcTemplate, ë§ˆì´ë°”í‹°ìŠ¤ë“± í•¨ê¼ ì‚¬ìš©ê°€ëŠ¥
  ë‹¨, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì ì ˆí•œ ì‹œì ì— ê°•ì œë¡œ í”ŒëŸ¬ì‹œ í•„ìš”
 ex: JPAë¥¼ ìš°íšŒí•´ì„œ SQLì„ ì‹¤í–‰í•˜ê¸° ì§ì „ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ìˆ˜ë™ í”ŒëŸ¬ì‹œ í•´ì¤˜ì•¼ í•œë‹¤.  Member member = new Member(); member.setUsername(&#34;catsbi&#34;); conn.createQuery(&#34;select * from Member where username = &#39;catsbi&#39;&#34;); //ê²°ê³¼ ì—†ìŒ memberëŠ” Jdbcê°€ ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ”ì‹œì ì—ì„œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ë§Œ ìˆê³  dbì— ì•„ì§ ì €ì¥ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì¡°íšŒê²°ê³¼ê°€ ì—†ë‹¤ ê·¸ëŸ¬ë¯€ë¡œ ì¿¼ë¦¬ ìˆ˜í–‰ ì „ ìˆ˜ë™ìœ¼ë¡œ í”ŒëŸ¬ì‹œë¥¼ í•´ì¤˜ì•¼ í•œë‹¤.
  2. ê¸°ë³¸ ë¬¸ë²•ê³¼ ì¿¼ë¦¬ API  JPQL ì†Œê°œ
 JPQLì€ ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ë‹¤. ë”°ë¼ì„œ í…Œì´ë¸”ì„ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬í•œë‹¤. JPQLì€ SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ SQLì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.  EX: ì¡°íšŒ ê¸°ëŠ¥ì„ ë§Œë“¤ ë•Œ íŠ¹ì • DBì— ì˜ì¡´í•˜ëŠ” SQLì„ ë”°ë¡œ ì•ˆë§Œë“¤ì–´ë„ ëœë‹¤.   JPQLì€ ê²°êµ­ SQLë¡œ ë³€í™˜ëœë‹¤.  ê°ì²´/DB ëª¨ë¸]]></description>
</item><item>
    <title>ê°’ íƒ€ì…</title>
    <link>https://jaeyeonme.github.io/posts/jpa-value-type/</link>
    <pubDate>Wed, 29 Dec 2021 14:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-value-type/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ê¸°ë³¸ê°’ íƒ€ì…  ì—”í‹°í‹° íƒ€ì…
  @Entityë¡œ ì •ì˜í•˜ëŠ” ê°ì²´
  ë°ì´í„°ê°€ ë³€í•´ë„ ì‹ë³„ìë¡œ ì§€ì†í•´ì„œ ì¶”ì  ê°€ëŠ¥
â‡’ ì—”í‹°í‹° ë‚´ë¶€ì˜ ëª¨ë“  ê°’ë“¤ì„ ë°”ê¿”ë„ ì‹ë³„ìë§Œ ìœ ì§€ë˜ë©´ ì¶”ì ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì˜ë¯¸
  Ex: íšŒì› ì—”í‹°í‹°ì˜ í‚¤ë‚˜ ë‚˜ì´ ê°’ì„ ë³€ê²½í•´ë„ ì‹ë³„ìë¡œ ì¸ì‹ ê°€ëŠ¥
  ê°’ íƒ€ì…
 int, integer, Stringì²˜ëŸ¼ ë‹¨ìˆœíˆ ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìë°” ê¸°ë³¸ íƒ€ì…ì´ë‚˜ ê°ì²´ ì‹ë³„ìê°€ ì—†ê³  ê°’ë§Œ ìˆìœ¼ë¯€ë¡œ ë³€ê²½ì‹œ ì¶”ì  ë¶ˆê°€ Ex: ìˆ«ì 100ì„ 200ìœ¼ë¡œ ë³€ê²½í•˜ë©´ ì™„ì „íˆ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ëŒ€ì²´  ê°’ íƒ€ì… ë¶„ë¥˜
 ê¸°ë³¸ê°’ íƒ€ì…  ìë°” ê¸°ë³¸ íƒ€ì…(int, double) ë˜í¼ í´ë˜ìŠ¤(Integer, Long) String   ì„ë² ë””ë“œ íƒ€ì…(enbedded type, ë³µí•© ê°’ íƒ€ì…)  Ex: ìš°í¸ë²ˆí˜¸, ì¢Œí‘œê°™ì€ ë³µí•© ê°’ì„ Positioní´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ ì“°ë ¤ê³  í•˜ëŠ” ê²ƒì„ ì„ë² ë””ë“œ íƒ€ì…   ì»¬ë ‰ì…˜ ê°’ íƒ€ì…(collection value type)  Java collection(Array, Map, Set)ì— ê°’ì„ ë„£ì„ìˆ˜ ìˆëŠ” ê²ƒì„ ì»¬ë ‰ì…˜ ê°’ íƒ€ì…ì´ë¼ í•œë‹¤.    ê°’ íƒ€ì… : ê¸°ë³¸ê°’ íƒ€ì…
 Ex: String name, int age ìƒëª…ì£¼ê¸°ë¥¼ ì—”í‹°í‹°ì— ì˜ì¡´  íšŒì›ì„ ì‚­ì œí•˜ë©´ ì´ë¦„, ë‚˜ì´ í•„ë“œë„ í•¨ê»˜ ì‚­ì œ   ê°’ íƒ€ì…ì€ ê³µìœ í•˜ë©´ ì•ˆëœë‹¤.  Side Effect â†’ íšŒì› ì´ë¦„ ë³€ê²½ì‹œ ë‹¤ë¥¸ íšŒì›ì˜ ì´ë¦„ë„ í•¨ê»˜ ë³€ê²½ë˜ë©´ ì•ˆëœë‹¤.     ì°¸ê³ : ìë°”ì˜ ê¸°ë³¸ íƒ€ì…ì€ ì ˆëŒ€ ê³µìœ ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤.  int, double ê°™ì€ ê¸°ë³¸ íƒ€ì…(primitive type)ì€ ì ˆëŒ€ ê³µìœ ë˜ì§€ ì•ŠëŠ”ë‹¤. ê¸°ë³¸ íƒ€ì…ì€ í•­ìƒ ê°’ì„ ë³µì‚¬í•¨ Integerê°™ì€ ë˜í¼ í´ë˜ìŠ¤ë‚˜ String ê°™ì€ íŠ¹ìˆ˜í•œ í´ë˜ìŠ¤ëŠ” ê³µìœ  ê°€ëŠ¥í•œ ê°ì²´ì´ì§€ë§Œ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤.    2. ì„ë² ë””ë“œ íƒ€ì…  ê°œìš”
 ìƒˆë¡œìš´ ê°’ íƒ€ì…ì„ ì§ì ‘ ì •ì˜í•  ìˆ˜ ìˆë‹¤. JPAëŠ” ì„ë² ë””ë“œ íƒ€ì…(embedded type)ì´ë¼ í•œë‹¤. ì£¼ë¡œ ê¸°ë³¸ ê°’ íƒ€ì…ì„ ëª¨ì•„ì„œ ë§Œë“¤ì–´ì„œ ë³µí•© ê°’ íƒ€ì…ì´ë¼ê³ ë„ í•¨ int, Stringê³¼ ê°™ì€ ê°’ íƒ€ì…  ì„ë² ë””ë“œ íƒ€ì… ì‚¬ìš©ë²•
 @Embeddable : ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ @Embedded : ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜   Example  ì˜ˆì œë¥¼ í†µí•´ ì•Œì•„ë³´ëŠ”ê²Œ ì´í•´í•˜ê¸° ì‰½ë‹¤.  íšŒì› ì—”í‹°í‹°ëŠ” ì´ë¦„, ê·¼ë¬´ ì‹œì‘ì¼, ê·¼ë¬´ ì¢…ë£Œì¼, ì£¼ì†Œ ë„ì‹œ, ì£¼ì†Œ ë²ˆì§€, ì£¼ì†Œ ìš°í¸ë²ˆí˜¸ë¥¼ ê°€ì§„ë‹¤.
  city, street, zipcodeëŠ” ì£¼ì†Œë¡œ í•©ì¹  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.
  ê·¼ë¬´ ì‹œì‘ì¼, ê·¼ë¬´ ì¢…ë£Œì¼ì€ ê·¼ë¬´ì‹œê°„ìœ¼ë¡œ í•©ì¹  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.
  íšŒì› ì—”í‹°í‹°ì˜ ëª‡ëª‡ ê°’ì„ ì£¼ì†Œ, ê·¼ë¬´ì‹œê°„ìœ¼ë¡œ í•©ì¹˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ.
ì½”ë“œë¥¼ í†µí•´ ì¢€ ë” ìì„¸íˆ ì•Œì•„ë³´ì.
@Embeddable //ê°’ íƒ€ì…ì´ ì •ì˜ë˜ëŠ” ê³³ì— @Embeddable ì‚¬ìš© public class Period { private LocalDateTime startDate; private LocalDateTime endDate; public Period() { } } @Embeddable //ê°’ íƒ€ì…ì´ ì •ì˜ë˜ëŠ” ê³³ì— @Embeddable ì‚¬ìš© public class Address { private String city; private String street; private String zipcode; public Address() { } } @Entity public class Member { @Id @GeneratedValue @Column(name = &#34;MEMBER_ID&#34;) private Long id; @Column(name = &#34;USERNAME&#34;) private String name; /* //ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì£¼ì„ ë‚´ì˜ ê¸°ì¡´ í˜•íƒœë¡œ ê°’ íƒ€ì…ìœ¼ë¡œ ì„ ì–¸í•´ì¤˜ì•¼ í•œë‹¤. //Period private LocalDateTime startDate; private LocalDateTime endDate; //Address private String city; private String street; private String zipcode; */ @Embedded //ê°’ íƒ€ì…ì´ ì‚¬ìš©ë˜ëŠ” ê³³ì— @Embedded ì‚¬ìš©  private Period workPeriod; @Embedded //ê°’ íƒ€ì…ì´ ì‚¬ìš©ë˜ëŠ” ê³³ì— @Embedded ì‚¬ìš©  private Address homeAddress; } 
ì„ë² ë””ë“œ íƒ€ì…ì˜ ì¥ì 
 ì¬ì‚¬ìš©  Periodë‚˜ AddressëŠ” ë‹¤ë¥¸ ê°ì²´ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ ì¬ì‚¬ìš©ì„±ì„ ë†’íŒë‹¤.   ë†’ì€ ì‘ì§‘ë„ Period.isWork()ì²˜ëŸ¼ í•´ë‹¹ ê°’ íƒ€ì…ë§Œ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ìˆëŠ” ë©”ì†Œë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ  private boolean isWork(){ ... }  ì„ë² ë””ë“œ íƒ€ì…ì„ í¬í•¨í•œ ëª¨ë“  ê°’ íƒ€ì…ì€, ê°’ íƒ€ì…ì„ ì†Œìœ í•œ ì—”í‹°í‹°ì— ìƒëª…ì£¼ê¸°ë¥¼ ì˜ì¡´í•œë‹¤.]]></description>
</item><item>
    <title>í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„ ê´€ë¦¬</title>
    <link>https://jaeyeonme.github.io/posts/jpa-proxy-and-management/</link>
    <pubDate>Wed, 29 Dec 2021 13:40:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-proxy-and-management/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. í”„ë¡ì‹œ   í”„ë¡ì‹œë€?
 í…Œì´ë¸”ì„ ì¡°íšŒí•´ì„œ ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ì—°ê´€ê´€ê³„ ê°ì²´ëŠ” ì•ˆê°€ì ¸ ì˜¤ê³  ì‹¶ìœ¼ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?
  em.find() : ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ
  em.getReference(): ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒë¥¼ ë¯¸ë£¨ëŠ” ê°€ì§œ(í”„ë¡ì‹œ) ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ
Member member = em.getReference(Member.class, 1L); System.out.println(&#34;member = &#34; + member.getClass()); // HibernateProxy ê°ì²´ getReference() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì§„ì§œ ê°ì²´ê°€ ì•„ë‹Œ í•˜ì´ë²„ë„¤ì´íŠ¸ ë‚´ë¶€ ë¡œì§ìœ¼ë¡œ í”„ë¡ì‹œ ì—”í‹°í‹° ê°ì²´ ë°˜í™˜
ë‚´ë¶€ êµ¬ì¡°ëŠ” í‹€ì€ ê°™ì§€ë§Œ ë‚´ìš©ì´ ë¹„ì–´ìˆë‹¤.
í”„ë¡ì‹œ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤." í”„ë¡ì‹œ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.    íŠ¹ì§•
  ì‹¤ì œ í´ë˜ìŠ¤ë¥¼ìƒì†ë°›ì•„ì„œ ë§Œë“¤ì–´ì§
  ì‹¤ì œ í´ë˜ìŠ¤ì™€ ê²‰ ëª¨ì–‘ì´ ê°™ë‹¤.
  ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œëŠ” ì§„ì§œ ê°ì²´ì¸ì§€ êµ¬ë¶„ í•„ìš”ê°€ ì—†ë‹¤. (ì´ë¡ ì ìœ¼ë¡œ)
  í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ì°¸ì¡°(target)ë¥¼ ë³´ê´€í•œë‹¤.
  í”„ë¡ì‹œ ê°ì²´ë¥¼ í˜¸ì¶œ(getName())í•˜ë©´ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ë©”ì†Œë“œ í˜¸ì¶œ
  í”„ë¡ì‹œëŠ” ì²˜ìŒ ì‚¬ìš©í•  ë•Œ í•œ ë²ˆë§Œ ì´ˆê¸°í™”
  í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ˆê¸°í™” í•  ë•Œ í”„ë¡ì‹œ ê°ì²´ê°€ ì‹¤ì œ ì—”í‹°í‹°ë¡œ ë°”ë€ŒëŠ” ê²ƒì€ ì•„ë‹˜, ì´ˆê¸°í™”ë˜ë©´ í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ ì‹¤ì œ ì—”í‹°í‹°ì— ì ‘ê·¼ ê°€ëŠ¥
  í”„ë¡ì‹œ ê°ì²´ëŠ” ì›ë³¸ ì—”í‹°í‹°ë¥¼ ìƒì†ë°›ìŒ, ë”°ë¼ì„œ íƒ€ì… ì²´í¬ì‹œ ì£¼ì˜í•´ì•¼í•¨( == ë¹„êµ ì‹¤íŒ¨, ëŒ€ì‹  instance of ì‚¬ìš©)
m1.getClass() == m2.getClass() //false m1 instanceof Member m2 instanceof Member     ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì°¾ëŠ” ì—”í‹°í‹°ê°€ ì´ë¯¸ ìˆìœ¼ë©´ em.getReference()ë¥¼ í˜¸ì¶œí•´ë„ ì‹¤ì œ ì—”í‹°í‹° ë°˜í™˜
Member m1 = em.find(Member.class, member1.getId()); System.out.println(&#34;m1 = &#34;+ m1.getClass());//Member  Member reference = em.getReference(Member.class, member1.getId()); System.out.println(&#34;reference = &#34; reference.getClass()); //Member  m1 == reference //true ì´ë¯¸ Memberë¥¼ 1ì°¨ ìºì‹œì—ë„ ì˜¬ë¼ì™€ ìˆëŠ”ë°, í”„ë¡ì‹œë¥¼ ë°˜í™˜í•  í•„ìš”ê°€ ì—†ë‹¤.
    ë°˜ëŒ€ë¡œ getReference()ë¡œ í”„ë¡ì‹œê°ì²´ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©´ ì‹¤ì œë¡œ find()ë¥¼ í–ˆì„ë•Œë„ í”„ë¡ì‹œ ê°ì²´ë¥¼ ë°˜í™˜í•¨
  ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ì—†ëŠ” ì¤€ì˜ì† ìƒíƒœì¼ ë•Œ, í”„ë¡ì‹œë¥¼ ì´ˆê¸°í™”í•˜ë©´ ë¬¸ì œ ë°œìƒ
Member refMember = em.getReference(Member.class, member.getId()); System.out.println(&#34;refMember = &#34;+ refMember.getClass());//Proxy  em.detach(refMember); //em.clear  refMember.getUsername(); //org.hibernate.LazyInitializationException   í”„ë¡ì‹œ ê°ì²´ì˜ ì´ˆê¸°í™”
Member member = em.getRefernce(Member.class, &#34;id1&#34;);//(1) member.getName();//(2) ì½”ë“œ 1ë¼ì¸ì—ì„œ getReference()ë¥¼ í˜¸ì¶œí•˜ë©´ í”„ë¡ì‹œê°ì²´ë¥¼ ê°€ì ¸ì˜¨ ë‹¤ìŒ, getName()ì„ í˜¸ì¶œí•˜ë©´
JPAê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì´ˆê¸°í™” ìš”ì²­ì„ í•œë‹¤.
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œëŠ” ì‹¤ì œ DBë¥¼ ì¡°íšŒí•´ì„œ ê°€ì ¸ì˜¨ ë‹¤ìŒ ì‹¤ì œ Entityì— ê°’ì„ ë„£ì–´ ìƒì„±í•œ ë‹¤ìŒ í”„ë¡ì‹œ ê°ì²´ëŠ”
ì‹¤ì œ ì—”í‹°í‹°ë¥¼ ì—°ê²°í•´ì„œ ì‹¤ì œ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•œë‹¤.
ê·¸ ì´í›„ì—ëŠ” ì´ë¯¸ ì´ˆê¸°í™”ë˜ì–´ìˆëŠ” í”„ë¡ì‹œê°ì²´ ì—¬ê¸°ì— í•´ë‹¹ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•œë‹¤.
í”„ë¡ì‹œ í™•ì¸
 í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ì˜ ì´ˆê¸°í™” ì—¬ë¶€ í™•ì¸ : PersistenceUnitUtil.isLoaded(Object entity) â†’ entityManagerFactory.getPersistenceUnitUtil().isLoaded(object) í”„ë¡ì‹œ í´ë˜ìŠ¤ í™•ì¸ ë°©ë²• : entity.getClass().getname() ì¶œë ¥(..javasist.. or HibernateProxy&hellip;) í”„ë¡ì‹œ ê°•ì œ ì´ˆê¸°í™” : org.hibernate.Hibernate.initialize(entity); ì°¸ê³ : JPA í‘œì¤€ì€ ê°•ì œ ì´ˆê¸°í™” ì—†ìŒ ê°•ì œí˜¸ì¶œ : method.getName();  2. ì¦‰ì‹œë¡œë”©ê³¼ ì§€ì—°ë¡œë”©  ì§€ì—° ë¡œë”© Memberë¥¼ ì¡°íšŒí•  ë•Œ Team(ì—°ê´€ê´€ê³„)ë„ í•¨ê»˜ ì¡°íšŒí•´ì•¼ í• ê¹Œ? : ë‹¨ìˆœíˆ member ì •ë³´ë§Œì‚¬ìš©í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
ì§€ì—° ë¡œë”© LAZYì„ ì‚¬ìš©í•´ì„œ í”„ë¡ì‹œë¡œ ì¡°íšŒ
fetch = FetchType.LAZY
/*Member*/ @Entity public class Member { ... @ManyToOne(fetch = FetchType.LAZY) //ì§€ì—°ë¡œë”© ì‚¬ìš©  @JoinColumn(name=&#34;TEAM_ID&#34;) private Team team; ... } ... Member m = em.find(Member.class, member1.getId()); // Member ê°ì²´ ë°˜í™˜ System.out.println(&#34;m = &#34;+ m.getTeam().getClass()); // Team$HibernateProxyê°ì²´ ë°˜í™˜ m.getTeam().getName() // teamì„ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ëŠ” ì‹œì ì—ì„œ dbì¡°íšŒ ì—”í‹°í‹° ë°˜í™˜ ... ì—°ê´€ê´€ê³„ì— ìˆëŠ” ë‹¤ë¥¸ ì—”í‹°í‹°ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¹ˆë„ìˆ˜ê°€ ë‚®ì„ ê²½ìš° ì§€ì—°ë¡œë”©ì„ ì‚¬ìš©í•´ ë¶ˆí•„ìš”í•œ ì—”í‹°í‹° ì¡°íšŒë¥¼ ë§‰ì„ ìˆ˜ ìˆë‹¤.
ì¦‰ì‹œ ë¡œë”© â“Memberì™€ Teamì„ ê°™ì´ ì“°ëŠ” ë¹ˆë„ê°€ ë†’ì„ ê²½ìš°ì—ëŠ” ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?
ì¦‰ì‹œ ë¡œë”© EAGERë¥¼ ì‚¬ìš©í•´ì„œ í•¨ê¼ ì¡°íšŒ fetch = FetchType.EAGER
/*Member*/ @Entity public class Member{ ... @ManyToOne(fetch = FetchType.EAGER) //ì¦‰ì‹œë¡œë”© ì‚¬ìš©  @JoinColumn(name=&#34;TEAM_ID&#34;) private Team team; ... } ... Member m = em.]]></description>
</item><item>
    <title>ê³ ê¸‰ ë§¤í•‘</title>
    <link>https://jaeyeonme.github.io/posts/jpa-advanced-mapping/</link>
    <pubDate>Wed, 29 Dec 2021 13:20:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-advanced-mapping/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ìƒì†ê´€ê³„ ë§¤í•‘   ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìƒì† ê´€ê³„X ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ê´€ê³„ë¼ëŠ” ëª¨ë¸ë§ ê¸°ë²•ì´ ê°ì²´ ìƒì†ê³¼ ìœ ì‚¬ ìƒì†ê´€ê³„ ë§¤í•‘ : ê°ì²´ì˜ ìƒì†ê³¼ êµ¬ì¡°ì™€ DBì˜ ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ê´€ê³„ë¥¼ ë§¤í•‘  Album, Movie, Bookì€ ëª¨ë‘ id, name, priceë¥¼ ê°€ì§€ê³  ìˆë‹¤(ê³µí†µ ë³€ìˆ˜)
ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ë…¼ë¦¬ ëª¨ë¸ì„ ì‹¤ì œ ë¬¼ë¦¬ ëª¨ë¸ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²• 1. ì¡°ì¸ì „ëµ  Item, Albumì— PK,FKê°€ ê°™ì•„ ê°ê°ì˜ í…Œì´ë¸”ì— insertê°€ ìˆ˜í–‰í•˜ê³  Itemë‚´ì— íƒ€ì…ì„ êµ¬ë¶„í•˜ëŠ” ì»¬ëŸ¼ì„ ë§Œë“¤ì–´ì„œ êµ¬í•´ì˜¨ë‹¤. ì¥ì   ì •ê·œí™”ë„ ë˜ì–´ìˆê³ , ì œì•½ì¡°ê±´ì„ ë¶€ëª¨ì— ê±¸ì–´ ë§ì¶œ ìˆ˜ ìˆë‹¤.  ex: Order í…Œì´ë¸”ì—ì„œ íŠ¹ì • ì•„ì´í…œ(ì˜í™”)ì˜ ê°€ê²©ì„ ë³¼ ë•Œ ITEM í…Œì´ë¸”ë§Œ ë´ë„ ëœë‹¤.   ì €ì¥ê³µê°„ íš¨ìœ¨í™”   ë‹¨ì   ì¡°íšŒì‹œ ì¡°ì¸ì´ ë§ì„ ê²½ìš° ì„±ëŠ¥ ì €í•˜ ì¡°íšŒ ì¿¼ë¦¬ê°€ ë³µì¡í•¨ ë°ì´í„° ì €ì¥ì‹œ INSERT SQL 2ë²ˆ í˜¸ì¶œ(í° ë¬¸ì œëŠ” ì•„ë‹˜)   ì¡°ì¸ì´ ë§ì•„ë„ ì¡°ê±´ì´ ì˜ ê±¸ë ¤ìˆì„ ê²½ìš° ì„±ëŠ¥ í•˜ë½ì´ í¬ì§€ ì•Šê³  ì €ì¥ê³µê°„ì´ íš¨ìœ¨ì ìœ¼ë¡œ ë˜ê¸°ì— ì˜¤íˆë ¤ ë” ì¢‹ì„ ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ê³ ë ¤í•´ì•¼ í•œë‹¤.  2. ë‹¨ì¼ í…Œì´ë¸” ì „ëµ (default)  ë…¼ë¦¬ëª¨ë¸ì„ í•œ í…Œì´ë¸”ë¡œ í•©ì³ë²„ë¦¬ëŠ” ë°©ë²• í•œ í…Œì´ë¸”ì— ë‹¤ ë„£ì–´ ë†“ê³  ì–´ë–¤ í…Œì´ë¸”ì¸ì§€ êµ¬ë¶„í•˜ëŠ” ì»¬ëŸ¼(ex:DTYPE)ì„ í†µí•´ êµ¬ë¶„í•œë‹¤. í…Œì´ë¸”ì€ ITEM í…Œì´ë¸” í•˜ë‚˜ë§Œ ê´€ë¦¬ëœë‹¤. ì„±ëŠ¥ì—ì„œ ìš°ìœ„ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. (select or insertê°€ í•œë²ˆì— ìˆ˜í–‰ìœ¼ë¡œ ëœë‹¤.) @DiscriminatorColumn ì´ í•„ìˆ˜ë¡œ ë“¤ì–´ê°„ë‹¤(ê¸°ì…í•˜ì§€ ì•Šì•„ë„ ìë™ìœ¼ë¡œ ë“¤ì–´ê°) ì¥ì   ì¡°ì¸ì´ í•„ìš” ì—†ê¸°ì— ì¼ë°˜ì ìœ¼ë¡œ ì¡°íšŒ ì„±ëŠ¥ì´ ë¹ ë¦„ ì¡°íšŒ ì¿¼ë¦¬ê°€ ë‹¨ìˆœí•¨   ë‹¨ì   ìì‹ ì—”í‹°í‹°ê°€ ë§¤í•‘í•œ ì»¬ëŸ¼ì€ ëª¨ë‘ nullable í•´ì•¼ í•œë‹¤. ë‹¨ì¼ í…Œì´ë¸”ì— ëª¨ë“  ê²ƒì„ ì €ì¥í•˜ê¸°ì— í…Œì´ë¸”ì´ ì»¤ì§ˆ ìˆ˜ ìˆê³  ìƒí™©ì— ë”°ë¼ì„œ ì¡°íšŒì„±ëŠ¥ì´ ë” ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤. (ì„ê³„ì ì„ ë„˜ì„ ì €ë„ì˜ ìƒí™©ì€ ê±°ì˜ ì˜¤ì§€ ì•ŠëŠ”ë‹¤.)    3. êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ  ê°ê°ì˜ í…Œì´ë¸”ë§ˆë‹¤ ë³„ê°œë¡œ ë§Œë“¤ì–´ì„œ ë”°ë¡œ ê´€ë¦¬ ITEM í…Œì´ë¸”ì„ ìƒì„±í•˜ì§€ ì•Šê³  ALBUM, MOVIE, BOOK í…Œì´ë¸”ì—ì„œ ê°ê° id, name, price í•„ë“œë¥¼ ê°€ì§€ê³  ìˆë‹¤. @DiscriminatorColumnì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. (êµ¬ë¶„í•  ì´ìœ ê°€ ì—†ë‹¤.) ITEMì„ ì¡°íšŒí•˜ë©´ ALBUM, MOVIE, BOOK ì„¸ê°œì˜ í…Œì´ë¸”ì„ UNION ALLìœ¼ë¡œ ì „ë¶€ ì¡°íšŒí•´ì„œ ê°€ì ¸ì˜¨ë‹¤. (ë‹¨ì ) ì¶”ì²œí•˜ì§€ ì•ŠëŠ” ì „ëµ (ê°œë°œì, DBA ì–‘ì¸¡ì—ì„œ) ì¥ì   ì„œë¸Œ íƒ€ì…ì„ ëª…í™•í•˜ê²Œ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬í•  ë•Œ íš¨ê³¼ì  Not Null ì œì•½ì¡°ê±´ ê°€ëŠ¥   ë‹¨ì   ì—¬ëŸ¬ ìì‹ í…Œì´ë¸”ì„ í•¨ê»˜ ì¡°íšŒí•  ë•Œ ì„±ëŠ¥ì´ ëŠë¦¼ (UNION SQL) ìì‹ í…Œì´ë¸”ì„ í†µí•©í•´ì„œ ì¿¼ë¦¬í•˜ê¸° í˜ë“¬    2. ì£¼ìš” ì–´ë…¸í…Œì´ì…˜ @Inheritance(strategy = InheritanceType.XXX)
 JOINED : ì¡°ì¸ì „ëµ SINGLE_TABLE : ë‹¨ì¼ í…Œì´ë¸” ì „ëµ TABLE_PER_CLASS : êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ  @DiscriminatorColumn(name = &ldquo;DTYPE&rdquo;)
 default : DTYPE ì´ë¼ëŠ” Columnì´ super classì˜ tableì— ìƒê¸°ê³ , DTYPEì˜ ê°’ì€ sub classì˜ ì´ë¦„ìœ¼ë¡œ ì§€ì •ëœë‹¤. SingleTable ì „ëµì—ì„œ ì—†ì–´ë„ DTYPEì´ ìƒì„±ë˜ê¸°ë„ í•˜ëŠ”ë°, ê·¸ë˜ë„ ìš´ì˜ìƒ ì¨ì£¼ì. ì´ ì–´ë…¸í…Œì´ì…˜ì€ ìƒìœ„ í´ë˜ìŠ¤(Item)ì—ì„œ ëª…ì‹œëœë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒìœ„ í…Œì´ë¸”(Item í…Œì´ë¸”)ì—ê²Œ êµ¬ë¶„ì ì—­í• ì„ DTYPE ì¹¼ëŸ¼ì„ ë„£ì–´ì¤€ë‹¤. ì• ë…¸í…Œì´ì…˜ì˜ name ì†ì„±ìœ¼ë¡œ ì»¬ëŸ¼ëª…ì„ ë°”ê¿”ì¤„ ìˆ˜ ìˆë‹¤ (ì´ë¦„ì†ì„±ìœ¼ë¡œ ì“°ì).  @DiscriminatorValue(â€œXXXâ€)
 ì´ ì–´ë…¸í…Œì´ì…˜ì€ í•˜ìœ„ í´ë˜ìŠ¤(ALBUM, MOVIE, BOOK)ì—ì„œ ì‚¬ìš©ëœë‹¤. ìƒìœ„ í…Œì´ë¸”(ITEM í…Œì´ë¸”)ì„ ì¡°íšŒí• ë•Œ DTYPE ì¹¼ëŸ¼ì— ì‚¬ìš©ë˜ëŠ” valueë¥¼ ì„¤ì •í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ë‹¤. ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš° ê¸°ë³¸ Default ê°’ì¸ Entity ì´ë¦„ìœ¼ë¡œ valueê°’ì´ ì±„ì›Œì§€ê²Œ ëœë‹¤. default: classname  3. @MappedSuperclass   ê³µí†µ ë§¤í•‘ ì •ë³´ê°€ í•„ìš”í•  ë•Œ ì‚¬ìš©(id, name)  ex: ëª¨ë“  í…Œì´ë¸”ì— row ìƒì„±ì¼, ìˆ˜ì •ì¼ì„ ë“±ë¡í•´ì•¼í•˜ëŠ” ê²½ìš°(createdAt, updatedAt)     ìƒì†ê´€ê³„ ë§¤í•‘ì´ ì•„ë‹ˆë‹¤. ì—”í‹°í‹°ë„ ì•„ë‹ˆê³ , í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ì§€ë„ ì•ŠëŠ”ë‹¤. ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” ìì‹ í´ë˜ìŠ¤ì— ë§¤í•‘ ì •ë³´ë§Œ ì œê³µ ë¶€ëª¨íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ, ê²€ìƒ‰ ë¶ˆê°€ ì§ì ‘ ìƒì„±í•´ì„œ ì‚¬ìš©í•  ì¼ì´ ì—†ìœ¼ë¯€ë¡œ ì¶”ìƒí´ë˜ìŠ¤ ì¶”ì²œ  @Entityí´ë˜ìŠ¤ëŠ” ì—”í‹°í‹°ë‚˜ @MappedSuperclassë¡œ ì§€ì •í•œ í´ë˜ìŠ¤ë§Œ ìƒì† ê°€ëŠ¥
@MappedSuperclass public abstract class BaseEntity { private String createdBy; private LocalDateTime createdDate; private String modifiedBy; private LocalDateTime lastModifiedDate; } @Entity public class Member extends BaseEntity { } @Entity public class Team extends BaseEntity { } Member member = new Member(); member.]]></description>
</item><item>
    <title>ë‹¤ì–‘í•œ ì—°ê´€ê´€ê³„ ë§¤í•‘</title>
    <link>https://jaeyeonme.github.io/posts/jpa-mapping-various-associations/</link>
    <pubDate>Wed, 29 Dec 2021 13:00:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-mapping-various-associations/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ì—°ê´€ê´€ê³„ ë§¤í•‘ì‹œ ê³ ë ¤ì‚¬í•­ 3ê°€ì§€   ë‹¤ì¤‘ì„±  ë‹¤ëŒ€ì¼ : @ManyToOne ì¼ëŒ€ë‹¤ : @OneToMany ì¼ëŒ€ì¼ : @OneToOne ë‹¤ëŒ€ë‹¤ : @ManyToMany â†’ ë‹¤ëŒ€ë‹¤ëŠ” ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤. ë‹¨ë°©í–¥, ì–‘ë°©í–¥  í…Œì´ë¸”  ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ ì–‘ìª½ ì¡°ì¸ ê°€ëŠ¥ ë°©í–¥ì´ë¼ëŠ” ê°œë…ì´ ì—†ìŒ ì–‘ìª½ì´ ì„œë¡œ ì°¸ì¡°í•˜ë©´ ì–‘ë°©í–¥       ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸  í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ ë‘ ë°ì´ë¸”ì˜ ì—°ê´€ê´€ê³„ë¥¼ ì°¾ìŒ ê°ì²´ ì•¼ë°©í–¥ ê´€ê³„ëŠ” A â†’ B, B â†’ A ì²˜ëŸ¼ ì°¸ì¡°ê°€ 2êµ°ë° ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸: ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ì°¸ì¡° ì£¼ì¸ì˜ ë°˜ëŒ€í¸ : ì™¸ë˜ í‚¤ì— ì˜í–¥ì„ ì£¼ì§€ì•Šê³  ë‹¨ìˆœ ì¡°íšŒ(ì°¸ì¡°)ë§Œ ê°€ëŠ¥    2. ë‹¤ëŒ€ì¼ [N:1]  ë‹¤ëŒ€ì¼(N:1) ë‹¨ë°©í–¥   ERD
ë‹¤ëŒ€ì¼(N:1)ë‹¨ë°©í–¥
 ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ì—°ê´€ê´€ê³„ ë‹¤ëŒ€ì¼ì˜ ë°˜ëŒ€ëŠ” ì¼ëŒ€ë‹¤    ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥   ERD
 ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ìª½ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ ì–‘ìª½ì„ ì„œë¡œ ì°¸ì¡°í•˜ë„ë¡ ê°œë°œ ì—°ê´€ê´€ê³„ê°€ ì£¼ì¸ì´ ì•„ë‹Œ ìª½ì€ ë‹¨ìˆœ ì¡°íšŒë§Œ ê°€ëŠ¥í•˜ê¸°ì— í•„ë“œë§Œ ì¶”ê°€í•´ì£¼ë©´ ëœë‹¤.  @OneToMany private List&lt;Member&gt; members = new ArrayList&lt;&gt;();   3. ì¼ëŒ€ë‹¤ [1:N]  ì¼(One)ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤. â†’ ê¶Œì¥í•˜ëŠ” ë°©ë²•ì€ ì•„ë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œë„ ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
  ERD
 í…Œì´ë¸” ì¼ëŒ€ë‹¤ ê´€ê³„ëŠ” í•­ìƒ ë‹¤(N) ìª½ì— ì™¸ë˜ í‚¤ê°€ ìˆë‹¤. ê°ì²´ì™€ í…Œì´ë¸”ì˜ ì°¨ì´ ë–„ë¬¸ì— ë°˜ëŒ€í¸ í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•˜ëŠ” íŠ¹ì´í•œ êµ¬ì¡°    ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ì´ìœ    í…Œì´ë¸”ì—ì„œëŠ” í•­ìƒ ë‹¤(N) ìª½ì— ì™¸ë˜í‚¤ê°€ ìˆê¸° ë•Œë¬¸ì— íŒ¨ëŸ¬ë‹¤ì„ì¶©ëŒì´ ìˆë‹¤.
  @JoinColumn ì„ ê¼­ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì¡°ì¸ í…Œì´ë¸” ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. (ì¤‘ê°„ì— í…Œì´ë¸”ì„ í•˜ë‚˜ ì¶”ê°€í•¨)
  ì‹¤ë¬´ì—ì„œëŠ” í…Œì´ë¸”ì´ ìˆ˜ì‹­ê°œ ì´ìƒ ìš´ì˜ì´ ë˜ëŠ”ë°, ê´€ë¦¬ ë° íŠ¸ë ˆì´ì‹±ì´ ì–´ë µë‹¤.
â†’ Ex) ì¼ëŒ€ë‹¤(1:N)ì—ì„œ ì €ì¥(save)ì´ ë  ë•Œ ì–‘ìª½ ê°ì²´ë¥¼ ì €ì¥í•œ ë’¤ update queryë¥¼ í†µí•´ ì™¸ë˜í‚¤ ì„¤ì •(3ë²ˆì´ë‚˜ ìˆ˜í–‰)
   ê²°ë¡ : ê¸°ë³¸ì€ ë‹¤ëŒ€ì¼(N:1)ë¡œ êµ¬í˜„í•˜ë‹¤ í•„ì˜¤ì— ì˜í•´ ì–‘ë°©í–¥ ë‹¤ëŒ€ì¼(N:1) ê´€ê³„ë¥¼ ìˆ˜ë¦½í•˜ë„ë¡ í•˜ì.
 ì¼ëŒ€ë‹¤(1:N)ì–‘ë°©í–¥   ERD
  ì´ëŸ° ë§¤í•‘ì€ ê³µì‹ì ìœ¼ë¡œëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
  @JoinColumn(insertable=false, updatable=false)
/* íŒ€(Team) */ public class Team{ ... @OneToMany @JoinColumn(name=&#34;TEAM_ID&#34;) private List&lt;Member&gt; members = new ArrayList&lt;&gt;(); ... } /* ë©¤ë²„(Member) */ public class Member{ ... @ManyToOne @JoinColumn(name=&#34;TEAM_ID&#34;, insertable=false, updatable=false) private Team team; ... } â†’ Member ENtityì˜ team fieldê°€ ì½ê¸°ì „ìš© fieldê°€ ëë‹¤.
     ì½ê¸° ì „ìš© í•„ë“œë¥¼ ì‚¬ìš©í•´ì„œ ì–‘ë°©í–¥ ì²˜ëŸ¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²• ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ì„ ì‚¬ìš©í•˜ì.  4. ì¼ëŒ€ì¼(1:1)   ì£¼ í…Œì´ë¸”ì´ë‚˜ ëŒ€ìƒ í…Œì´ë¸” ì¤‘ì— ì™¸ë˜ í‚¤ ì„ íƒ ê°€ëŠ¥ ì™¸ë˜í‚¤ì— ë°ì´í„°ë² ì´ìŠ¤ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ ì¶”ê°€ ë‹¤ëŒ€ì¼ ì—°ê´€ê´€ê³„ì™€ ë™ì¼í•˜ê²Œ ì™¸ë˜í‚¤ê°€ ìˆëŠ”ê³³ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì— mappedByë¥¼ ë„£ì–´ì¤€ë‹¤. ì •ë¦¬  ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤  ì£¼ ê°ì²´ê°€ ëŒ€ìƒ ê°ì²´ì˜ ì°¸ì¡°ë¥¼ ê°€ì§€ëŠ” ê²ƒì²˜ëŸ¼ ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ë¥¼ ë‘ê³  ëŒ€ìƒ í…Œì´ë¸”ì„ ì°¾ìŒ ê°ì²´ì§€í–¥ ê°œë°œì ì„ í˜¸ JPA ë§¤í•‘ ì •ë¦¬ ì¥ì  : ì£¼ í…Œì´ë¸”ë§Œ ì¡°íšŒí•´ë„ ëŒ€ìƒ í…Œì´ë¸”ì— ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸ ê°€ëŠ¥ ë‹¨ì  : ê°’ì´ ì—†ìœ¼ë©´ ì™¸ë˜ í‚¤ì— null í—ˆìš©   ëŒ€ìƒ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤  ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ì¡´ì¬ ì „í†µì ì¸ ë°ì´í„°ë² ì´ìŠ¤ ê°œë°œì ì„ í˜¸ ì¥ì  : ì£¼ í…Œì´ë¸”ê³¼ ëŒ€ìƒ í…Œì´ë¸”ì„ ì¼ëŒ€ì¼ì—ì„œ ì¼ëŒ€ë‹¤ ê´€ê³„ë¡œ ë³€ê²½í•  ë•Œ í…Œì´ë¸” êµ¬ì¡° ìœ ì§€ ë‹¨ì  : ì£¼ í…Œì´ë¸”ì—ëŠ” ì™¸ë˜ í‚¤ê°€ ì—†ê¸° ë•Œë¬¸ì— ëŒ€ìƒ í…Œì´ë¸”ì´ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì¦‰ì‹œë¡œë”©ì´ ë¬´ì¡°ê±´ ëœë‹¤.      5. ë‹¤ëŒ€ë‹¤ [N:M]   ì‹¤ë¬´ì—ì„œëŠ” ê±°ìœ¼ ã…£ì‚¬ìš©í•˜ì§€ë„ ì•Šê³  ì¶”ì²œí•˜ì§€ë„ ì•ŠëŠ” ì—°ê´€ê´€ê³„ ê°ì²´ëŠ” ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•´ì„œ ê°ì²´ 2ê°œë¡œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ ê°€ëŠ¥ @ManyToMany ì‚¬ìš© @JoinTableë¡œ ì—°ê²° í…Œì´ë¸” ì§€ì •  ë‹¤ëŒ€ë‹¤ ë§¤í•‘ì˜ í•œê³„  í¸ë¦¬í•´ ë³´ì´ì§€ë§Œ ì‹¤ë¬´ì—ì„œ ì‚¬ìš©ì•ˆí•¨ ì—°ê²µ í…Œì´ë¸”ì´ ë‹¨ìˆœíˆ ì—°ê²°ë§Œ í•˜ê³  ëë‚˜ì§€ ì•ŠìŒ ì£¼ë¬¸ì‹œê°„, ìˆ˜ëŸ‰ ê°™ì€ ë°ì´í„°ê°€ ë“¤ì–´ì˜¬ ìˆ˜ ìˆìŒ.]]></description>
</item><item>
    <title>ì—°ê´€ê´€ê³„ ë§¤í•‘ ê¸°ì´ˆ</title>
    <link>https://jaeyeonme.github.io/posts/jpa-mapping-basics/</link>
    <pubDate>Wed, 29 Dec 2021 12:50:00 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://jaeyeonme.github.io/posts/jpa-mapping-basics/</guid>
    <description><![CDATA[<div class="featured-image">
                <img src="/images/JPA/jpa.png" referrerpolicy="no-referrer">
            </div>1. ì—°ê´€ê´€ê³„ì˜ í•„ìš”ì„±  : ê°ì²´ì§€í–¥ ì„¤ê³„ì˜ ëª©í‘œëŠ” ììœ¨ì ì¸ ê°ì²´ë“¤ì˜ í˜‘ë ¥ ê³µë™ì²´ë¥¼ ë§Œë“œëŠ” ê²ƒì´ë‹¤.
2. ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶° ë°ì´í„° ì¤‘ì‹¬ìœ¼ë¡œ ëª¨ë¸ë§í•˜ë©´, í˜‘ë ¥ ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤. 2-1. ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§(ì—°ê´€ê´€ê³„ê°€ ì—†ëŠ” ê°ì²´)   ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§ (ì°¸ì¡° ëŒ€ì‹ ì— ì™¸ë˜ í‚¤ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
/* íšŒì›(Member) ì—”í‹°í‹°*/ @Entity public class Member { @Id @GeneratedValue private Long id; @Column(name = &#34;USERNAME&#34;) private String name; @Column(name = &#34;TEAM_ID&#34;) private Long teamId; } /* íŒ€(Team) ì—”í‹°í‹° */ @Entity public class Team{ @Id @GeneratedValue private Long id; private String name; }  ê°ì²´ë¥¼ ìœ„ì™€ ê°™ì´ í…Œì´ë¸”ì— ë§ì¶° ëª¨ë¸ë§ì„ í•  ê²½ìš° ìƒê¸°ëŠ” ë¬¸ì œëŠ” ë¬´ì—‡ì¼ê¹Œ?      ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶° ëª¨ë¸ë§ í–ˆì„ ê²½ìš° DBì— ì €ì¥&amp;ì¡°íšŒí•˜ëŠ” ë¡œì§
/* íŒ€ê³¼ ë©¤ë²„ë¥¼ ì €ì¥í•˜ëŠ” ë¡œì§ */ Team team = new Team(); team.setName(&#34;teamA&#34;); em.persist(team); Member member = new Member(); member.setName(&#34;mamber1&#34;); member.setTeamId(team.getId()); em.persist(member);  ì™¸ë˜í‚¤ ì‹ë³„ìë¥¼ ì§ì ‘ë‹¤ë£¨ê³  ìˆëŠ”ë°, ì´ëŸ´ ê²½ìš° ë¬¸ì œëŠ”? â†’ ì¡°íšŒí•  ë•Œ ì—­ì‹œ í•´ë‹¹ ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ì¡°ì¸ ì¿¼ë¦¬ë¥¼ ì§ì ‘ ì§œì•¼ í•œë‹¤. Q. member1 ì´ ì†Œì†ëœ íŒ€ ì •ë³´ë¥¼ ì¡°íšŒí•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í•˜ëŠ”ê°€?  Member findMember = em.find(Member.class, member.getId()); Long findTeamId = findMember.getTeamId(); Team findTeam = em.find(Team.class, findTeamId);  ë§¤ë²ˆ memberë¥¼ ìš°ì„  ì¡°íšŒí•œ ë’¤ ì™¸ë˜í‚¤ë¥¼ ë½‘ì•„ ê·¸ê²ƒìœ¼ë¡œ íŒ€ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•´ì•¼ í•œë‹¤. â†’ í˜‘ë ¥ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤.    Hibernate: create table Member ( MEMBER_ID bigint not null, TEAM_ID bigint, USERNAME varchar(255), primary key (MEMBER_ID) ) Hibernate: create table Team ( TEAM_ID bigint not null, name varchar(255), primary key (TEAM_ID) )  ê²°ë¡ : ì™¸ë˜í‚¤ë¥¼ ì§ì ‘ ê´€ë¦¬í•˜ëŠ” í…Œì´ë¸”ì— ë§ì¶˜ ê°ì²´ ëª¨ë¸ë§ì€ ê°ì²´ê°„ì˜ í˜‘ë ¥ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ê³ , ê°ì²´ê°€ ì°¸ì¡°ë¥¼ í†µí•´ ì—°ê´€ê°ì²´ë¥¼ ì°¾ëŠ” ë‹¤ëŠ” ì‚¬ìƒì„ ì ìš©í•  ìˆ˜ ì—†ë‹¤. ì´ ë§ì€ ê°ì²´ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì˜ íŒ¨ëŸ¬ë‹¤ì„ì„ ì •ë©´ìœ¼ë¡œ ë°˜ë°•í•˜ëŠ” ê²ƒ.
  ê°ì²´ ì§€í–¥ ëª¨ë¸ë§ (ê°ì²´ ì—°ê´€ê´€ê³„ ì‚¬ìš©)
   ê°ì²´ ì§€í–¥ì ìœ¼ë¡œ ì—”í‹°í‹° ì„¤ê³„(ê°ì²´ ì—°ê´€ê´€ê³„ ì‚¬ìš©)
/* íšŒì›(Member) ì—”í‹°í‹°*/ @Entity public class Member { @Id @GeneratedValue private Long id; @Column(name = &#34;USERNAME&#34;) private String name; @ManyToOne @JoinColumn(name = &#34;team_id&#34;) private Team team; ... getter, setter }  @ManyToOne @JoinColumn ì„ í†µí•´ ë©¤ë²„(Member)ì—ì„œ íŒ€(Team)ì„ ì°¸ì¡°í•˜ë„ë¡ í—€ë‹¤.    Team team = new Team(); team.setName(&#34;teamA&#34;); em.persist(team); Member member = new Member(); member.setName(&#34;mamber1&#34;); member.setTeam(team); em.persist(member); em.flush(); em.clear(); Member findMember = em.find(Member.class, member.getId()); Team findTeam = member.getTeam(); 
3. ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì™€ ì—°ê´€ê´€ê³„ ì£¼ì¸1 - ê¸°ë³¸    ë‹¨ë°©í–¥ì—ì„œ ì–‘ë°©í–¥ì´ ëœë‹¤ëŠ” ê²ƒì˜ ì˜ë¯¸ëŠ” ì–‘ì¸¡ì—ì„œ ì„œë¡œ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ê¸°ì¡´ ë‹¨ë°©í–¥ì—ì„œëŠ” Member ì—ì„œ getTeam()ì„ í†µí•´ Team ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆì§€ë§Œ Team ì—ì„œëŠ” Member ë¥¼ ì°¸ì¡°í•  ìˆ˜ ì—†ì—ˆë‹¤. í•˜ì§€ë§Œ í…Œì´ë¸” ì—°ê´€ê´€ê³„ì—ì„œëŠ” ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ì–‘ì¸¡ì—ì„œ ì„œë¡œë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤.
  Team ê°ì²´ì— membersë¼ëŠ” Listë¥¼ ì¶”ê°€í•´ì„œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.
@Entity public class Team{ ... @OneToMany(mappedBy = &#34;team&#34;) private List&lt;Member&gt; members = new ArrayList&lt;&gt;(); ... }     ì¶”ê°€í•œ members ë¥¼ í™•ì¸í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì.
Member findMember = em.find(Member.class, member.getId()); List&lt;Member&gt; members = findMember.getTeam().getMembers(); for (Member member1 : members) { System.out.println(&#34;member1.getName() = &#34; + member1.getName()); // member1.getName() = mamber1 }  ì´ì œ ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œë„ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ì´ ê°€ëŠ¥í•´ì¡Œë‹¤.    ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ê³¼ mappedBy  mappedBy = ì—°ê´€ê´€ê³„ì˜ ê°œë…ì— ëŒ€í•´ ì´í•´ë¥¼ ì–´ë µê²Œ ë§Œë“œëŠ” ì£¼ë²”! ê°ì²´ì™€ í…Œì´ë¸”ê°„ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ” ì°¨ì´ë¥¼ ì´í•´í•´ì•¼ í•œë‹¤.  ê°ì²´ì™€ í…Œì´ë¸”ì´ ê´€ê³„ë¥¼ ë§ºëŠ” ì°¨ì´ë€?  ê°ì²´ ì—°ê´€ê´€ê³„ = 2ê°œ  íšŒì› â†’ íŒ€ ì—°ê´€ê´€ê³„ 1ê°œ(ë‹¨ë°©í–¥) íŒ€ â†’ íšŒì› ì—°ê´€ê´€ê³„ 1ê°œ(ë‹¨ë°©í–¥)   í…Œì´ë¸” ì—°ê´€ê´€ê³„ = 1ê°œ  íšŒì› â†â†’ íŒ€ì˜ ì—°ê´€ê´€ê³„ 1ê°œ(ì–‘ë°©í–¥)    ê²°êµ­ ì–‘ë°©í–¥ ê´€ê³„ë€  ê°ì²´ì˜ ì–‘ë°©í–¥ ê´€ê³„ëŠ” ì‚¬ì‹¤ ì–‘ë°©í–¥ ê´€ê³„ê°€ ì•„ë‹ˆë¼ ì„œë¡œ ë‹¤ë¥¸ ë‹¨ë°©í–¥ ê´€ê³„ 2ê°œë‹¤.]]></description>
</item></channel>
</rss>
